<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>DEx.Model</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/tferariu/agda2plinth/tree/main///DEx/Model.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="DEx.Model.html" class="Module">DEx.Model</a> <a id="18" class="Keyword">where</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a>

<a id="CurrencySymbol"></a><a id="54" href="DEx.Model.html#54" class="Function">CurrencySymbol</a> <a id="69" class="Symbol">=</a> <a id="71" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
<a id="TokenName"></a><a id="75" href="DEx.Model.html#75" class="Function">TokenName</a> <a id="85" class="Symbol">=</a> <a id="87" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="PubKeyHash"></a><a id="92" href="DEx.Model.html#92" class="Function">PubKeyHash</a> <a id="103" class="Symbol">=</a> <a id="105" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
<a id="Address"></a><a id="109" href="DEx.Model.html#109" class="Function">Address</a> <a id="117" class="Symbol">=</a> <a id="119" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="AssetClass"></a><a id="124" href="DEx.Model.html#124" class="Function">AssetClass</a> <a id="135" class="Symbol">=</a> <a id="137" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="142" class="Keyword">record</a> <a id="Value"></a><a id="149" href="DEx.Model.html#149" class="Record">Value</a> <a id="155" class="Symbol">:</a> <a id="157" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="161" class="Keyword">where</a>
    <a id="171" class="Keyword">field</a> <a id="Value.amount"></a><a id="177" href="DEx.Model.html#177" class="Field">amount</a>   <a id="186" class="Symbol">:</a> <a id="188" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
          <a id="Value.currency"></a><a id="206" href="DEx.Model.html#206" class="Field">currency</a> <a id="215" class="Symbol">:</a> <a id="217" href="DEx.Model.html#124" class="Function">AssetClass</a>
<a id="228" class="Keyword">open</a> <a id="233" href="DEx.Model.html#149" class="Module">Value</a> <a id="239" class="Keyword">public</a>

<a id="addValue"></a><a id="247" href="DEx.Model.html#247" class="Function">addValue</a> <a id="256" class="Symbol">:</a> <a id="258" href="DEx.Model.html#149" class="Record">Value</a> <a id="264" class="Symbol">→</a> <a id="266" href="DEx.Model.html#149" class="Record">Value</a> <a id="272" class="Symbol">→</a> <a id="274" href="DEx.Model.html#149" class="Record">Value</a>
<a id="280" href="DEx.Model.html#247" class="Function">addValue</a> <a id="289" href="DEx.Model.html#289" class="Bound">a</a> <a id="291" href="DEx.Model.html#291" class="Bound">b</a> <a id="293" class="Symbol">=</a> <a id="295" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="300" href="DEx.Model.html#206" class="Field">currency</a> <a id="309" href="DEx.Model.html#289" class="Bound">a</a> <a id="311" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="314" href="DEx.Model.html#206" class="Field">currency</a> <a id="323" href="DEx.Model.html#291" class="Bound">b</a> <a id="325" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="328" class="Symbol">λ</a> <a id="330" class="Keyword">where</a>
  <a id="338" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a> <a id="343" class="Symbol">→</a> <a id="345" class="Keyword">record</a> <a id="352" class="Symbol">{</a> <a id="354" href="DEx.Model.html#177" class="Field">amount</a> <a id="361" class="Symbol">=</a> <a id="363" href="DEx.Model.html#177" class="Field">amount</a> <a id="370" href="DEx.Model.html#289" class="Bound">a</a> <a id="372" href="Haskell.Prim.Num.html#547" class="Field Operator">+</a> <a id="374" href="DEx.Model.html#177" class="Field">amount</a> <a id="381" href="DEx.Model.html#291" class="Bound">b</a> <a id="383" class="Symbol">;</a> <a id="385" href="DEx.Model.html#206" class="Field">currency</a> <a id="394" class="Symbol">=</a> <a id="396" href="DEx.Model.html#206" class="Field">currency</a> <a id="405" href="DEx.Model.html#289" class="Bound">a</a> <a id="407" class="Symbol">}</a>
  <a id="411" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="417" class="Symbol">→</a> <a id="419" href="DEx.Model.html#289" class="Bound">a</a>

<a id="eqValue"></a><a id="422" href="DEx.Model.html#422" class="Function">eqValue</a> <a id="430" class="Symbol">:</a> <a id="432" href="DEx.Model.html#149" class="Record">Value</a> <a id="438" class="Symbol">→</a> <a id="440" href="DEx.Model.html#149" class="Record">Value</a> <a id="446" class="Symbol">→</a> <a id="448" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="453" href="DEx.Model.html#422" class="Function">eqValue</a> <a id="461" href="DEx.Model.html#461" class="Bound">a</a> <a id="463" href="DEx.Model.html#463" class="Bound">b</a> <a id="465" class="Symbol">=</a> <a id="467" class="Symbol">(</a><a id="468" href="DEx.Model.html#177" class="Field">amount</a> <a id="475" href="DEx.Model.html#461" class="Bound">a</a> <a id="477" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="480" href="DEx.Model.html#177" class="Field">amount</a> <a id="487" href="DEx.Model.html#463" class="Bound">b</a><a id="488" class="Symbol">)</a> <a id="490" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
              <a id="507" class="Symbol">(</a><a id="508" href="DEx.Model.html#206" class="Field">currency</a> <a id="517" href="DEx.Model.html#461" class="Bound">a</a> <a id="519" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="522" href="DEx.Model.html#206" class="Field">currency</a> <a id="531" href="DEx.Model.html#463" class="Bound">b</a><a id="532" class="Symbol">)</a>

<a id="535" class="Keyword">instance</a>
  <a id="iEqValue"></a><a id="546" href="DEx.Model.html#546" class="Function">iEqValue</a> <a id="555" class="Symbol">:</a> <a id="557" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="560" href="DEx.Model.html#149" class="Record">Value</a>
  <a id="568" href="DEx.Model.html#546" class="Function">iEqValue</a> <a id="577" class="Symbol">.</a><a id="578" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="583" class="Symbol">=</a> <a id="585" href="DEx.Model.html#422" class="Function">eqValue</a>

  <a id="iSemigroupValue"></a><a id="596" href="DEx.Model.html#596" class="Function">iSemigroupValue</a> <a id="612" class="Symbol">:</a> <a id="614" href="Haskell.Prim.Monoid.html#288" class="Record">Semigroup</a> <a id="624" href="DEx.Model.html#149" class="Record">Value</a>
  <a id="632" href="DEx.Model.html#596" class="Function">iSemigroupValue</a> <a id="648" class="Symbol">.</a><a id="649" href="Haskell.Prim.Monoid.html#344" class="Field Operator">_&lt;&gt;_</a> <a id="654" class="Symbol">=</a> <a id="656" href="DEx.Model.html#247" class="Function">addValue</a>

<a id="666" class="Keyword">record</a> <a id="Rational"></a><a id="673" href="DEx.Model.html#673" class="Record">Rational</a> <a id="682" class="Symbol">:</a> <a id="684" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="688" class="Keyword">where</a>
    <a id="698" class="Keyword">field</a> <a id="Rational.num"></a><a id="704" href="DEx.Model.html#704" class="Field">num</a>    <a id="711" class="Symbol">:</a> <a id="713" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
          <a id="Rational.den"></a><a id="731" href="DEx.Model.html#731" class="Field">den</a>    <a id="738" class="Symbol">:</a> <a id="740" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="748" class="Keyword">open</a> <a id="753" href="DEx.Model.html#673" class="Module">Rational</a> <a id="762" class="Keyword">public</a>

<a id="numerator"></a><a id="770" href="DEx.Model.html#770" class="Function">numerator</a> <a id="780" class="Symbol">:</a> <a id="782" href="DEx.Model.html#673" class="Record">Rational</a> <a id="791" class="Symbol">→</a> <a id="793" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="801" href="DEx.Model.html#770" class="Function">numerator</a> <a id="811" href="DEx.Model.html#811" class="Bound">r</a> <a id="813" class="Symbol">=</a> <a id="815" href="DEx.Model.html#704" class="Field">num</a> <a id="819" href="DEx.Model.html#811" class="Bound">r</a>

<a id="denominator"></a><a id="822" href="DEx.Model.html#822" class="Function">denominator</a> <a id="834" class="Symbol">:</a> <a id="836" href="DEx.Model.html#673" class="Record">Rational</a> <a id="845" class="Symbol">→</a> <a id="847" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="855" href="DEx.Model.html#822" class="Function">denominator</a> <a id="867" href="DEx.Model.html#867" class="Bound">r</a> <a id="869" class="Symbol">=</a> <a id="871" href="DEx.Model.html#731" class="Field">den</a> <a id="875" href="DEx.Model.html#867" class="Bound">r</a>

<a id="checkRational"></a><a id="878" href="DEx.Model.html#878" class="Function">checkRational</a> <a id="892" class="Symbol">:</a> <a id="894" href="DEx.Model.html#673" class="Record">Rational</a> <a id="903" class="Symbol">→</a> <a id="905" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="910" href="DEx.Model.html#878" class="Function">checkRational</a> <a id="924" href="DEx.Model.html#924" class="Bound">r</a> <a id="926" class="Symbol">=</a> <a id="928" class="Symbol">(</a><a id="929" href="DEx.Model.html#770" class="Function">numerator</a> <a id="939" href="DEx.Model.html#924" class="Bound">r</a> <a id="941" href="Haskell.Prim.Ord.html#1120" class="Field Operator">&gt;=</a> <a id="944" class="Number">0</a><a id="945" class="Symbol">)</a> <a id="947" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="950" class="Symbol">(</a><a id="951" href="DEx.Model.html#822" class="Function">denominator</a> <a id="963" href="DEx.Model.html#924" class="Bound">r</a> <a id="965" href="Haskell.Prim.Ord.html#1096" class="Field Operator">&gt;</a> <a id="967" class="Number">0</a><a id="968" class="Symbol">)</a>

<a id="Cmap"></a><a id="971" href="DEx.Model.html#971" class="Function">Cmap</a> <a id="976" class="Symbol">=</a> <a id="978" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="983" class="Symbol">((</a><a id="985" href="DEx.Model.html#673" class="Record">Rational</a> <a id="994" href="Haskell.Prim.Tuple.html#169" class="Record Operator">×</a> <a id="996" href="DEx.Model.html#92" class="Function">PubKeyHash</a><a id="1006" class="Symbol">)</a> <a id="1008" href="Haskell.Prim.Tuple.html#169" class="Record Operator">×</a> <a id="1010" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a><a id="1017" class="Symbol">)</a>

<a id="1020" class="Keyword">record</a> <a id="Label"></a><a id="1027" href="DEx.Model.html#1027" class="Record">Label</a> <a id="1033" class="Symbol">:</a> <a id="1035" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1039" class="Keyword">where</a>
  <a id="1047" class="Keyword">field</a> <a id="Label.ratio"></a><a id="1053" href="DEx.Model.html#1053" class="Field">ratio</a>  <a id="1060" class="Symbol">:</a> <a id="1062" href="DEx.Model.html#673" class="Record">Rational</a>
        <a id="Label.owner"></a><a id="1079" href="DEx.Model.html#1079" class="Field">owner</a>  <a id="1086" class="Symbol">:</a> <a id="1088" href="DEx.Model.html#92" class="Function">PubKeyHash</a>
<a id="1099" class="Keyword">open</a> <a id="1104" href="DEx.Model.html#1027" class="Module">Label</a> <a id="1110" class="Keyword">public</a>

<a id="1118" class="Symbol">{-#</a> <a id="1122" class="Keyword">COMPILE</a> <a id="1130" class="Keyword">AGDA2HS</a> <a id="1138" href="DEx.Model.html#1027" class="Record">Label</a> <a id="1144" class="Symbol">#-}</a>

<a id="eqRational"></a><a id="1149" href="DEx.Model.html#1149" class="Function">eqRational</a> <a id="1160" class="Symbol">:</a> <a id="1162" href="DEx.Model.html#673" class="Record">Rational</a> <a id="1171" class="Symbol">→</a> <a id="1173" href="DEx.Model.html#673" class="Record">Rational</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1189" href="DEx.Model.html#1149" class="Function">eqRational</a> <a id="1200" href="DEx.Model.html#1200" class="Bound">b</a> <a id="1202" href="DEx.Model.html#1202" class="Bound">c</a> <a id="1204" class="Symbol">=</a> <a id="1206" class="Symbol">(</a><a id="1207" href="DEx.Model.html#704" class="Field">num</a> <a id="1211" href="DEx.Model.html#1200" class="Bound">b</a> <a id="1213" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1216" href="DEx.Model.html#704" class="Field">num</a> <a id="1220" href="DEx.Model.html#1202" class="Bound">c</a><a id="1221" class="Symbol">)</a> <a id="1223" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                 <a id="1243" class="Symbol">(</a><a id="1244" href="DEx.Model.html#731" class="Field">den</a> <a id="1248" href="DEx.Model.html#1200" class="Bound">b</a> <a id="1250" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1253" href="DEx.Model.html#731" class="Field">den</a> <a id="1257" href="DEx.Model.html#1202" class="Bound">c</a><a id="1258" class="Symbol">)</a>


<a id="ltRational"></a><a id="1262" href="DEx.Model.html#1262" class="Function">ltRational</a> <a id="1273" class="Symbol">:</a> <a id="1275" href="DEx.Model.html#673" class="Record">Rational</a> <a id="1284" class="Symbol">→</a> <a id="1286" href="DEx.Model.html#673" class="Record">Rational</a> <a id="1295" class="Symbol">→</a> <a id="1297" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1302" href="DEx.Model.html#1262" class="Function">ltRational</a> <a id="1313" href="DEx.Model.html#1313" class="Bound">b</a> <a id="1315" href="DEx.Model.html#1315" class="Bound">c</a> <a id="1317" class="Symbol">=</a> <a id="1319" href="DEx.Model.html#704" class="Field">num</a> <a id="1323" href="DEx.Model.html#1313" class="Bound">b</a> <a id="1325" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="1327" href="DEx.Model.html#731" class="Field">den</a> <a id="1331" href="DEx.Model.html#1315" class="Bound">c</a> <a id="1333" href="Haskell.Prim.Ord.html#1072" class="Field Operator">&lt;</a> <a id="1335" href="DEx.Model.html#704" class="Field">num</a> <a id="1339" href="DEx.Model.html#1315" class="Bound">c</a> <a id="1341" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="1343" href="DEx.Model.html#731" class="Field">den</a> <a id="1347" href="DEx.Model.html#1313" class="Bound">b</a>

<a id="1350" class="Keyword">instance</a>
  <a id="iEqRational"></a><a id="1361" href="DEx.Model.html#1361" class="Function">iEqRational</a> <a id="1373" class="Symbol">:</a> <a id="1375" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1378" href="DEx.Model.html#673" class="Record">Rational</a>
  <a id="1389" href="DEx.Model.html#1361" class="Function">iEqRational</a> <a id="1401" class="Symbol">.</a><a id="1402" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1407" class="Symbol">=</a> <a id="1409" href="DEx.Model.html#1149" class="Function">eqRational</a>

<a id="1421" class="Keyword">instance</a>
  <a id="iEqLabel"></a><a id="1432" href="DEx.Model.html#1432" class="Function">iEqLabel</a> <a id="1441" class="Symbol">:</a> <a id="1443" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1446" href="DEx.Model.html#1027" class="Record">Label</a>
  <a id="1454" href="DEx.Model.html#1432" class="Function">iEqLabel</a> <a id="1463" class="Symbol">.</a><a id="1464" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1469" href="DEx.Model.html#1469" class="Bound">b</a> <a id="1471" href="DEx.Model.html#1471" class="Bound">c</a> <a id="1473" class="Symbol">=</a> <a id="1475" class="Symbol">(</a><a id="1476" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="1482" href="DEx.Model.html#1469" class="Bound">b</a> <a id="1484" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1487" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="1493" href="DEx.Model.html#1471" class="Bound">c</a><a id="1494" class="Symbol">)</a> <a id="1496" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="1499" class="Symbol">(</a><a id="1500" href="DEx.Model.html#1079" class="Field">owner</a> <a id="1506" href="DEx.Model.html#1469" class="Bound">b</a> <a id="1508" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1511" href="DEx.Model.html#1079" class="Field">owner</a> <a id="1517" href="DEx.Model.html#1471" class="Bound">c</a><a id="1518" class="Symbol">)</a>

<a id="1521" class="Keyword">data</a> <a id="OutputDatum"></a><a id="1526" href="DEx.Model.html#1526" class="Datatype">OutputDatum</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1544" class="Keyword">where</a>
  <a id="OutputDatum.Payment"></a><a id="1552" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="1560" class="Symbol">:</a> <a id="1562" href="DEx.Model.html#109" class="Function">Address</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="DEx.Model.html#1526" class="Datatype">OutputDatum</a>
  <a id="OutputDatum.Script"></a><a id="1586" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a>  <a id="1594" class="Symbol">:</a> <a id="1596" href="DEx.Model.html#1027" class="Record">Label</a>   <a id="1604" class="Symbol">→</a> <a id="1606" href="DEx.Model.html#1526" class="Datatype">OutputDatum</a>

<a id="1619" class="Keyword">instance</a>
  <a id="iEqDatum"></a><a id="1630" href="DEx.Model.html#1630" class="Function">iEqDatum</a> <a id="1639" class="Symbol">:</a> <a id="1641" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1644" href="DEx.Model.html#1526" class="Datatype">OutputDatum</a>
  <a id="1658" href="DEx.Model.html#1630" class="Function">iEqDatum</a> <a id="1667" class="Symbol">.</a><a id="1668" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1673" class="Symbol">=</a> <a id="1675" class="Symbol">λ</a> <a id="1677" class="Keyword">where</a>
    <a id="1687" class="Symbol">(</a><a id="1688" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="1696" href="DEx.Model.html#1696" class="Bound">x</a><a id="1697" class="Symbol">)</a> <a id="1699" class="Symbol">(</a><a id="1700" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="1708" href="DEx.Model.html#1708" class="Bound">y</a><a id="1709" class="Symbol">)</a> <a id="1711" class="Symbol">→</a> <a id="1713" href="DEx.Model.html#1696" class="Bound">x</a> <a id="1715" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1718" href="DEx.Model.html#1708" class="Bound">y</a>
    <a id="1724" class="Symbol">(</a><a id="1725" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="1733" href="DEx.Model.html#1733" class="Bound">x</a><a id="1734" class="Symbol">)</a> <a id="1736" class="Symbol">(</a><a id="1737" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="1744" href="DEx.Model.html#1744" class="Bound">y</a><a id="1745" class="Symbol">)</a>  <a id="1748" class="Symbol">→</a> <a id="1750" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a>
    <a id="1760" class="Symbol">(</a><a id="1761" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="1768" href="DEx.Model.html#1768" class="Bound">x</a><a id="1769" class="Symbol">)</a>  <a id="1772" class="Symbol">(</a><a id="1773" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="1781" href="DEx.Model.html#1781" class="Bound">y</a><a id="1782" class="Symbol">)</a> <a id="1784" class="Symbol">→</a> <a id="1786" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a>
    <a id="1796" class="Symbol">(</a><a id="1797" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="1804" href="DEx.Model.html#1804" class="Bound">x</a><a id="1805" class="Symbol">)</a>  <a id="1808" class="Symbol">(</a><a id="1809" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="1816" href="DEx.Model.html#1816" class="Bound">y</a><a id="1817" class="Symbol">)</a>  <a id="1820" class="Symbol">→</a> <a id="1822" href="DEx.Model.html#1804" class="Bound">x</a> <a id="1824" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1827" href="DEx.Model.html#1816" class="Bound">y</a>

<a id="1830" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="1835" href="DEx.Model.html#1835" class="Datatype">ScriptPurpose</a> <a id="1849" class="Symbol">:</a> <a id="1851" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1855" class="Keyword">where</a>
  <a id="ScriptPurpose.Spending"></a><a id="1863" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="1872" class="Symbol">:</a> <a id="1874" href="DEx.Model.html#109" class="Function">Address</a>        <a id="1889" class="Symbol">→</a> <a id="1891" href="DEx.Model.html#1835" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Minting"></a><a id="1907" href="DEx.Model.html#1907" class="InductiveConstructor">Minting</a>  <a id="1916" class="Symbol">:</a> <a id="1918" href="DEx.Model.html#54" class="Function">CurrencySymbol</a> <a id="1933" class="Symbol">→</a> <a id="1935" href="DEx.Model.html#1835" class="Datatype">ScriptPurpose</a>

<a id="1950" class="Keyword">record</a> <a id="TxOut"></a><a id="1957" href="DEx.Model.html#1957" class="Record">TxOut</a> <a id="1963" class="Symbol">:</a> <a id="1965" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1969" class="Keyword">where</a>
  <a id="1977" class="Keyword">field</a> <a id="TxOut.txOutAddress"></a><a id="1983" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="1996" class="Symbol">:</a> <a id="1998" href="DEx.Model.html#109" class="Function">Address</a>
        <a id="TxOut.txOutValue"></a><a id="2014" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="2025" class="Symbol">:</a> <a id="2027" href="DEx.Model.html#149" class="Record">Value</a>
        <a id="TxOut.txOutDatum"></a><a id="2041" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="2052" class="Symbol">:</a> <a id="2054" href="DEx.Model.html#1526" class="Datatype">OutputDatum</a>
<a id="2066" class="Keyword">open</a> <a id="2071" href="DEx.Model.html#1957" class="Module">TxOut</a> <a id="2077" class="Keyword">public</a>

<a id="2085" class="Keyword">record</a> <a id="ScriptContext"></a><a id="2092" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="2106" class="Symbol">:</a> <a id="2108" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2112" class="Keyword">where</a>
    <a id="2122" class="Keyword">field</a> <a id="ScriptContext.txOutputs"></a><a id="2128" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="2138" class="Symbol">:</a> <a id="2140" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2145" href="DEx.Model.html#1957" class="Record">TxOut</a>
          <a id="ScriptContext.inputVal"></a><a id="2161" href="DEx.Model.html#2161" class="Field">inputVal</a>  <a id="2171" class="Symbol">:</a> <a id="2173" href="DEx.Model.html#149" class="Record">Value</a>
          <a id="ScriptContext.inputAc"></a><a id="2189" href="DEx.Model.html#2189" class="Field">inputAc</a>   <a id="2199" class="Symbol">:</a> <a id="2201" href="DEx.Model.html#124" class="Function">AssetClass</a>
          <a id="ScriptContext.signature"></a><a id="2222" href="DEx.Model.html#2222" class="Field">signature</a> <a id="2232" class="Symbol">:</a> <a id="2234" href="DEx.Model.html#92" class="Function">PubKeyHash</a>
          <a id="ScriptContext.purpose"></a><a id="2255" href="DEx.Model.html#2255" class="Field">purpose</a>   <a id="2265" class="Symbol">:</a> <a id="2267" href="DEx.Model.html#1835" class="Datatype">ScriptPurpose</a>
<a id="2281" class="Keyword">open</a> <a id="2286" href="DEx.Model.html#2092" class="Module">ScriptContext</a> <a id="2300" class="Keyword">public</a>

<a id="checkSigned"></a><a id="2308" href="DEx.Model.html#2308" class="Function">checkSigned</a> <a id="2320" class="Symbol">:</a> <a id="2322" href="DEx.Model.html#92" class="Function">PubKeyHash</a> <a id="2333" class="Symbol">→</a> <a id="2335" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="2349" class="Symbol">→</a> <a id="2351" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="2356" href="DEx.Model.html#2308" class="Function">checkSigned</a> <a id="2368" href="DEx.Model.html#2368" class="Bound">sig</a> <a id="2372" href="DEx.Model.html#2372" class="Bound">ctx</a> <a id="2376" class="Symbol">=</a> <a id="2378" href="DEx.Model.html#2368" class="Bound">sig</a> <a id="2382" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="2385" href="DEx.Model.html#2222" class="Field">signature</a> <a id="2395" href="DEx.Model.html#2372" class="Bound">ctx</a>

<a id="2400" class="Keyword">data</a> <a id="Input"></a><a id="2405" href="DEx.Model.html#2405" class="Datatype">Input</a> <a id="2411" class="Symbol">:</a> <a id="2413" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2417" class="Keyword">where</a>
  <a id="Input.Update"></a><a id="2425" href="DEx.Model.html#2425" class="InductiveConstructor">Update</a>   <a id="2434" class="Symbol">:</a> <a id="2436" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="2444" class="Symbol">→</a> <a id="2446" href="DEx.Model.html#673" class="Record">Rational</a> <a id="2455" class="Symbol">→</a> <a id="2457" href="DEx.Model.html#2405" class="Datatype">Input</a>
  <a id="Input.Exchange"></a><a id="2465" href="DEx.Model.html#2465" class="InductiveConstructor">Exchange</a> <a id="2474" class="Symbol">:</a> <a id="2476" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="2484" class="Symbol">→</a> <a id="2486" href="DEx.Model.html#92" class="Function">PubKeyHash</a> <a id="2497" class="Symbol">→</a> <a id="2499" href="DEx.Model.html#2405" class="Datatype">Input</a>
  <a id="Input.Close"></a><a id="2507" href="DEx.Model.html#2507" class="InductiveConstructor">Close</a>    <a id="2516" class="Symbol">:</a> <a id="2518" href="DEx.Model.html#2405" class="Datatype">Input</a>

<a id="2525" class="Symbol">{-#</a> <a id="2529" class="Keyword">COMPILE</a> <a id="2537" class="Keyword">AGDA2HS</a> <a id="2545" href="DEx.Model.html#2405" class="Datatype">Input</a> <a id="2551" class="Symbol">#-}</a>

<a id="2556" class="Keyword">record</a> <a id="Params"></a><a id="2563" href="DEx.Model.html#2563" class="Record">Params</a> <a id="2570" class="Symbol">:</a> <a id="2572" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2576" class="Keyword">where</a>
    <a id="2586" class="Keyword">field</a> <a id="Params.sellC"></a><a id="2592" href="DEx.Model.html#2592" class="Field">sellC</a> <a id="2598" class="Symbol">:</a> <a id="2600" href="DEx.Model.html#124" class="Function">AssetClass</a>
          <a id="Params.buyC"></a><a id="2621" href="DEx.Model.html#2621" class="Field">buyC</a>  <a id="2627" class="Symbol">:</a> <a id="2629" href="DEx.Model.html#124" class="Function">AssetClass</a>
<a id="2640" class="Keyword">open</a> <a id="2645" href="DEx.Model.html#2563" class="Module">Params</a> <a id="2652" class="Keyword">public</a>

<a id="2660" class="Symbol">{-#</a> <a id="2664" class="Keyword">COMPILE</a> <a id="2672" class="Keyword">AGDA2HS</a> <a id="2680" href="DEx.Model.html#2563" class="Record">Params</a> <a id="2687" class="Symbol">#-}</a>

<a id="getContinuingOutputs"></a><a id="2692" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="2713" class="Symbol">:</a> <a id="2715" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="2729" class="Symbol">→</a> <a id="2731" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2736" href="DEx.Model.html#1957" class="Record">TxOut</a>
<a id="2742" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="2763" class="Keyword">record</a> <a id="2770" class="Symbol">{</a> <a id="2772" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="2782" class="Symbol">=</a> <a id="2784" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2787" class="Symbol">;</a> <a id="2789" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="2797" class="Symbol">=</a> <a id="2799" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="2808" href="DEx.Model.html#2808" class="Bound">x</a> <a id="2810" class="Symbol">}</a>
  <a id="2814" class="Symbol">=</a> <a id="2816" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2819" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="2840" href="DEx.Model.html#2840" class="Bound">ctx</a><a id="2843" class="Symbol">@</a><a id="2844" class="Keyword">record</a> <a id="2851" class="Symbol">{</a> <a id="2853" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="2863" class="Symbol">=</a> <a id="2865" href="DEx.Model.html#2865" class="Bound">o</a> <a id="2867" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2869" href="DEx.Model.html#2869" class="Bound">os</a><a id="2871" class="Symbol">;</a> <a id="2873" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="2881" class="Symbol">=</a> <a id="2883" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="2892" href="DEx.Model.html#2892" class="Bound">adr</a> <a id="2896" class="Symbol">}</a>
  <a id="2900" class="Symbol">=</a> <a id="2902" class="Keyword">let</a> <a id="2906" href="DEx.Model.html#2906" class="Bound">os</a> <a id="2909" class="Symbol">=</a> <a id="2911" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="2932" class="Symbol">(</a><a id="2933" class="Keyword">record</a> <a id="2940" href="DEx.Model.html#2840" class="Bound">ctx</a> <a id="2944" class="Symbol">{</a> <a id="2946" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="2956" class="Symbol">=</a> <a id="2958" href="DEx.Model.html#2869" class="Bound">os</a> <a id="2961" class="Symbol">})</a> <a id="2964" class="Keyword">in</a>
    <a id="2971" href="Haskell.Prim.html#1713" class="Function Operator">if</a> <a id="2974" href="DEx.Model.html#2892" class="Bound">adr</a> <a id="2978" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="2981" href="DEx.Model.html#2865" class="Bound">o</a> <a id="2983" class="Symbol">.</a><a id="2984" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="2997" href="Haskell.Prim.html#1713" class="Function Operator">then</a>
      <a id="3008" href="DEx.Model.html#2865" class="Bound">o</a> <a id="3010" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3012" href="DEx.Model.html#2906" class="Bound">os</a>
    <a id="3019" href="Haskell.Prim.html#1713" class="Function Operator">else</a>
      <a id="3030" href="DEx.Model.html#2906" class="Bound">os</a>
<a id="3033" href="DEx.Model.html#2692" class="CatchallClause Function">getContinuingOutputs</a><a id="3053" class="CatchallClause"> </a><a id="3054" class="CatchallClause Keyword">record</a><a id="3060" class="CatchallClause"> </a><a id="3061" class="CatchallClause Symbol">{</a><a id="3062" class="CatchallClause"> </a><a id="3063" href="DEx.Model.html#2255" class="CatchallClause Field">purpose</a><a id="3070" class="CatchallClause"> </a><a id="3071" class="CatchallClause Symbol">=</a><a id="3072" class="CatchallClause"> </a><a id="3073" href="DEx.Model.html#1907" class="CatchallClause InductiveConstructor">Minting</a><a id="3080" class="CatchallClause"> </a><a id="3081" href="DEx.Model.html#3081" class="CatchallClause Bound">x</a><a id="3082" class="CatchallClause"> </a><a id="3083" class="CatchallClause Symbol">}</a>
  <a id="3087" class="Symbol">=</a> <a id="3089" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="ownOutput"></a><a id="3093" href="DEx.Model.html#3093" class="Function">ownOutput</a> <a id="3103" class="Symbol">:</a> <a id="3105" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3119" class="Symbol">→</a> <a id="3121" href="DEx.Model.html#1957" class="Record">TxOut</a>
<a id="3127" href="DEx.Model.html#3093" class="Function">ownOutput</a> <a id="3137" href="DEx.Model.html#3137" class="Bound">ctx</a> <a id="3141" class="Symbol">=</a> <a id="3143" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="3148" class="Symbol">(</a><a id="3149" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="3170" href="DEx.Model.html#3137" class="Bound">ctx</a><a id="3173" class="Symbol">)</a> <a id="3175" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="3178" class="Symbol">λ</a> <a id="3180" class="Keyword">where</a>
  <a id="3188" class="Symbol">(</a><a id="3189" href="DEx.Model.html#3189" class="Bound">o</a> <a id="3191" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3193" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3195" class="Symbol">)</a> <a id="3197" class="Symbol">→</a> <a id="3199" href="DEx.Model.html#3189" class="Bound">o</a>
  <a id="3203" class="CatchallClause Symbol">_</a> <a id="3205" class="Symbol">→</a> <a id="3207" class="Keyword">record</a> <a id="3214" class="Symbol">{</a> <a id="3216" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="3229" class="Symbol">=</a> <a id="3231" class="Number">0</a> <a id="3233" class="Symbol">;</a> <a id="3235" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="3246" class="Symbol">=</a> <a id="3248" class="Keyword">record</a> <a id="3255" class="Symbol">{</a> <a id="3257" href="DEx.Model.html#177" class="Field">amount</a> <a id="3264" class="Symbol">=</a> <a id="3266" class="Number">-1</a> <a id="3269" class="Symbol">;</a> <a id="3271" href="DEx.Model.html#206" class="Field">currency</a> <a id="3280" class="Symbol">=</a> <a id="3282" class="Number">0</a> <a id="3284" class="Symbol">}</a> <a id="3286" class="Symbol">;</a> <a id="3288" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="3299" class="Symbol">=</a> <a id="3301" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="3309" class="Number">0</a> <a id="3311" class="Symbol">}</a>

<a id="oldValue"></a><a id="3314" href="DEx.Model.html#3314" class="Function">oldValue</a> <a id="3323" class="Symbol">:</a> <a id="3325" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3339" class="Symbol">→</a> <a id="3341" href="DEx.Model.html#149" class="Record">Value</a>
<a id="3347" href="DEx.Model.html#3314" class="Function">oldValue</a> <a id="3356" href="DEx.Model.html#3356" class="Bound">ctx</a> <a id="3360" class="Symbol">=</a> <a id="3362" href="DEx.Model.html#2161" class="Field">inputVal</a> <a id="3371" href="DEx.Model.html#3356" class="Bound">ctx</a>

<a id="newLabel"></a><a id="3376" href="DEx.Model.html#3376" class="Function">newLabel</a> <a id="3385" class="Symbol">:</a> <a id="3387" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3401" class="Symbol">→</a> <a id="3403" href="DEx.Model.html#1027" class="Record">Label</a>
<a id="3409" href="DEx.Model.html#3376" class="Function">newLabel</a> <a id="3418" href="DEx.Model.html#3418" class="Bound">ctx</a> <a id="3422" class="Symbol">=</a> <a id="3424" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="3429" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="3440" class="Symbol">(</a><a id="3441" href="DEx.Model.html#3093" class="Function">ownOutput</a> <a id="3451" href="DEx.Model.html#3418" class="Bound">ctx</a><a id="3454" class="Symbol">)</a> <a id="3456" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="3459" class="Symbol">λ</a> <a id="3461" class="Keyword">where</a>
  <a id="3469" class="Symbol">(</a><a id="3470" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="3477" href="DEx.Model.html#3477" class="Bound">x</a><a id="3478" class="Symbol">)</a> <a id="3480" class="Symbol">→</a> <a id="3482" href="DEx.Model.html#3477" class="Bound">x</a>
  <a id="3486" class="CatchallClause Symbol">_</a> <a id="3488" class="Symbol">→</a> <a id="3490" class="Keyword">record</a> <a id="3497" class="Symbol">{</a> <a id="3499" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="3505" class="Symbol">=</a> <a id="3507" class="Keyword">record</a> <a id="3514" class="Symbol">{</a> <a id="3516" href="DEx.Model.html#704" class="Field">num</a> <a id="3520" class="Symbol">=</a> <a id="3522" class="Number">0</a> <a id="3524" class="Symbol">;</a> <a id="3526" href="DEx.Model.html#731" class="Field">den</a> <a id="3530" class="Symbol">=</a> <a id="3532" class="Number">0</a> <a id="3534" class="Symbol">}</a> <a id="3536" class="Symbol">;</a> <a id="3538" href="DEx.Model.html#1079" class="Field">owner</a> <a id="3544" class="Symbol">=</a> <a id="3546" class="Number">0</a> <a id="3548" class="Symbol">}</a>

<a id="newValue"></a><a id="3551" href="DEx.Model.html#3551" class="Function">newValue</a> <a id="3560" class="Symbol">:</a> <a id="3562" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3576" class="Symbol">→</a> <a id="3578" href="DEx.Model.html#149" class="Record">Value</a>
<a id="3584" href="DEx.Model.html#3551" class="Function">newValue</a> <a id="3593" href="DEx.Model.html#3593" class="Bound">ctx</a> <a id="3597" class="Symbol">=</a> <a id="3599" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="3610" class="Symbol">(</a><a id="3611" href="DEx.Model.html#3093" class="Function">ownOutput</a> <a id="3621" href="DEx.Model.html#3593" class="Bound">ctx</a><a id="3624" class="Symbol">)</a>

<a id="isSingleton"></a><a id="3627" href="DEx.Model.html#3627" class="Function">isSingleton</a> <a id="3639" class="Symbol">:</a> <a id="3641" class="Symbol">∀</a> <a id="3643" class="Symbol">{</a><a id="3644" href="DEx.Model.html#3644" class="Bound">A</a> <a id="3646" class="Symbol">:</a> <a id="3648" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3651" class="Symbol">}</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3660" href="DEx.Model.html#3644" class="Bound">A</a> <a id="3662" class="Symbol">→</a> <a id="3664" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="3669" href="DEx.Model.html#3627" class="Function">isSingleton</a> <a id="3681" href="DEx.Model.html#3681" class="Bound">xs</a> <a id="3684" class="Symbol">=</a> <a id="3686" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="3691" href="DEx.Model.html#3681" class="Bound">xs</a> <a id="3694" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="3697" class="Symbol">λ</a> <a id="3699" class="Keyword">where</a>
  <a id="3707" class="Symbol">(_</a> <a id="3710" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3712" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3714" class="Symbol">)</a> <a id="3716" class="Symbol">→</a> <a id="3718" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a>
  <a id="3725" class="CatchallClause Symbol">_</a>        <a id="3734" class="Symbol">→</a> <a id="3736" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a>

<a id="continuing"></a><a id="3743" href="DEx.Model.html#3743" class="Function">continuing</a> <a id="3754" class="Symbol">:</a> <a id="3756" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3770" class="Symbol">→</a> <a id="3772" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="3777" href="DEx.Model.html#3743" class="Function">continuing</a> <a id="3788" href="DEx.Model.html#3788" class="Bound">ctx</a> <a id="3792" class="Symbol">=</a> <a id="3794" href="DEx.Model.html#3627" class="Function">isSingleton</a> <a id="3806" class="Symbol">(</a><a id="3807" href="DEx.Model.html#2692" class="Function">getContinuingOutputs</a> <a id="3828" href="DEx.Model.html#3788" class="Bound">ctx</a><a id="3831" class="Symbol">)</a>

<a id="ratioCompare"></a><a id="3834" href="DEx.Model.html#3834" class="Function">ratioCompare</a> <a id="3847" class="Symbol">:</a> <a id="3849" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="3857" class="Symbol">→</a> <a id="3859" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="3867" class="Symbol">→</a> <a id="3869" href="DEx.Model.html#673" class="Record">Rational</a> <a id="3878" class="Symbol">→</a> <a id="3880" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="3885" href="DEx.Model.html#3834" class="Function">ratioCompare</a> <a id="3898" href="DEx.Model.html#3898" class="Bound">a</a> <a id="3900" href="DEx.Model.html#3900" class="Bound">b</a> <a id="3902" href="DEx.Model.html#3902" class="Bound">r</a> <a id="3904" class="Symbol">=</a> <a id="3906" href="DEx.Model.html#3898" class="Bound">a</a> <a id="3908" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="3910" class="Symbol">(</a><a id="3911" href="DEx.Model.html#704" class="Field">num</a> <a id="3915" href="DEx.Model.html#3902" class="Bound">r</a><a id="3916" class="Symbol">)</a> <a id="3918" href="Haskell.Prim.Ord.html#1144" class="Field Operator">&lt;=</a> <a id="3921" href="DEx.Model.html#3900" class="Bound">b</a> <a id="3923" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="3925" class="Symbol">(</a><a id="3926" href="DEx.Model.html#731" class="Field">den</a> <a id="3930" href="DEx.Model.html#3902" class="Bound">r</a><a id="3931" class="Symbol">)</a>


<a id="getPaymentOutput"></a><a id="3935" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="3952" class="Symbol">:</a> <a id="3954" href="DEx.Model.html#109" class="Function">Address</a> <a id="3962" class="Symbol">→</a> <a id="3964" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="3978" class="Symbol">→</a> <a id="3980" href="DEx.Model.html#1957" class="Record">TxOut</a>
<a id="3986" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="4003" href="DEx.Model.html#4003" class="Bound">adr</a> <a id="4007" class="Keyword">record</a> <a id="4014" class="Symbol">{</a> <a id="4016" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="4026" class="Symbol">=</a> <a id="4028" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4031" class="Symbol">;</a> <a id="4033" href="DEx.Model.html#2161" class="Field">inputVal</a> <a id="4042" class="Symbol">=</a> <a id="4044" href="DEx.Model.html#4044" class="Bound">inputVal</a> <a id="4053" class="Symbol">;</a> <a id="4055" href="DEx.Model.html#2222" class="Field">signature</a> <a id="4065" class="Symbol">=</a> <a id="4067" href="DEx.Model.html#4067" class="Bound">signature</a> <a id="4077" class="Symbol">;</a> <a id="4079" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="4087" class="Symbol">=</a> <a id="4089" class="Symbol">(</a><a id="4090" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="4099" href="DEx.Model.html#4099" class="Bound">x</a><a id="4100" class="Symbol">)</a> <a id="4102" class="Symbol">}</a>
  <a id="4106" class="Symbol">=</a> <a id="4108" class="Keyword">record</a> <a id="4115" class="Symbol">{</a> <a id="4117" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="4130" class="Symbol">=</a> <a id="4132" class="Number">0</a> <a id="4134" class="Symbol">;</a> <a id="4136" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="4147" class="Symbol">=</a> <a id="4149" class="Keyword">record</a> <a id="4156" class="Symbol">{</a> <a id="4158" href="DEx.Model.html#177" class="Field">amount</a> <a id="4165" class="Symbol">=</a> <a id="4167" class="Number">-1</a> <a id="4170" class="Symbol">;</a> <a id="4172" href="DEx.Model.html#206" class="Field">currency</a> <a id="4181" class="Symbol">=</a> <a id="4183" class="Number">0</a> <a id="4185" class="Symbol">}</a>
           <a id="4198" class="Symbol">;</a> <a id="4200" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="4211" class="Symbol">=</a> <a id="4213" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="4220" class="Symbol">(</a><a id="4221" class="Keyword">record</a> <a id="4228" class="Symbol">{</a> <a id="4230" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="4236" class="Symbol">=</a> <a id="4238" class="Keyword">record</a> <a id="4245" class="Symbol">{</a> <a id="4247" href="DEx.Model.html#704" class="Field">num</a> <a id="4251" class="Symbol">=</a> <a id="4253" class="Number">0</a> <a id="4255" class="Symbol">;</a> <a id="4257" href="DEx.Model.html#731" class="Field">den</a> <a id="4261" class="Symbol">=</a> <a id="4263" class="Number">0</a> <a id="4265" class="Symbol">}</a> <a id="4267" class="Symbol">;</a> <a id="4269" href="DEx.Model.html#1079" class="Field">owner</a> <a id="4275" class="Symbol">=</a> <a id="4277" class="Number">0</a> <a id="4279" class="Symbol">})</a> <a id="4282" class="Symbol">}</a>
<a id="4284" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="4301" href="DEx.Model.html#4301" class="Bound">adr</a> <a id="4305" class="Keyword">record</a> <a id="4312" class="Symbol">{</a> <a id="4314" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="4324" class="Symbol">=</a> <a id="4326" class="Symbol">(</a><a id="4327" href="DEx.Model.html#4327" class="Bound">txO</a> <a id="4331" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4333" href="DEx.Model.html#4333" class="Bound">txOutputs</a><a id="4342" class="Symbol">)</a> <a id="4344" class="Symbol">;</a> <a id="4346" href="DEx.Model.html#2161" class="Field">inputVal</a> <a id="4355" class="Symbol">=</a> <a id="4357" href="DEx.Model.html#4357" class="Bound">inputVal</a> <a id="4366" class="Symbol">;</a> <a id="4368" href="DEx.Model.html#2189" class="Field">inputAc</a> <a id="4376" class="Symbol">=</a> <a id="4378" href="DEx.Model.html#4378" class="Bound">inputAc</a>
                            <a id="4414" class="Symbol">;</a> <a id="4416" href="DEx.Model.html#2222" class="Field">signature</a> <a id="4426" class="Symbol">=</a> <a id="4428" href="DEx.Model.html#4428" class="Bound">signature</a> <a id="4438" class="Symbol">;</a> <a id="4440" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="4448" class="Symbol">=</a> <a id="4450" class="Symbol">(</a><a id="4451" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="4460" href="DEx.Model.html#4460" class="Bound">x</a><a id="4461" class="Symbol">)</a> <a id="4463" class="Symbol">}</a>
  <a id="4467" class="Symbol">=</a> <a id="4469" href="Haskell.Prim.html#1713" class="Function Operator">if</a> <a id="4472" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="4485" href="DEx.Model.html#4327" class="Bound">txO</a> <a id="4489" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4492" href="DEx.Model.html#4301" class="Bound">adr</a> <a id="4496" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="4499" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="4510" href="DEx.Model.html#4327" class="Bound">txO</a> <a id="4514" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4517" class="Symbol">(</a><a id="4518" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="4526" href="DEx.Model.html#4460" class="Bound">x</a><a id="4527" class="Symbol">)</a>
       <a id="4536" href="Haskell.Prim.html#1713" class="Function Operator">then</a> <a id="4541" href="DEx.Model.html#4327" class="Bound">txO</a>
       <a id="4552" href="Haskell.Prim.html#1713" class="Function Operator">else</a> <a id="4557" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="4574" href="DEx.Model.html#4301" class="Bound">adr</a> <a id="4578" class="Symbol">(</a><a id="4579" class="Keyword">record</a> <a id="4586" class="Symbol">{</a> <a id="4588" href="DEx.Model.html#2128" class="Field">txOutputs</a> <a id="4598" class="Symbol">=</a> <a id="4600" href="DEx.Model.html#4333" class="Bound">txOutputs</a> <a id="4610" class="Symbol">;</a> <a id="4612" href="DEx.Model.html#2161" class="Field">inputVal</a> <a id="4621" class="Symbol">=</a> <a id="4623" href="DEx.Model.html#4357" class="Bound">inputVal</a> <a id="4632" class="Symbol">;</a> <a id="4634" href="DEx.Model.html#2189" class="Field">inputAc</a> <a id="4642" class="Symbol">=</a> <a id="4644" href="DEx.Model.html#4378" class="Bound">inputAc</a>
                                 <a id="4685" class="Symbol">;</a> <a id="4687" href="DEx.Model.html#2222" class="Field">signature</a> <a id="4697" class="Symbol">=</a> <a id="4699" href="DEx.Model.html#4428" class="Bound">signature</a> <a id="4709" class="Symbol">;</a> <a id="4711" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="4719" class="Symbol">=</a> <a id="4721" class="Symbol">(</a><a id="4722" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="4731" href="DEx.Model.html#4460" class="Bound">x</a><a id="4732" class="Symbol">)</a> <a id="4734" class="Symbol">})</a>
<a id="4737" href="DEx.Model.html#3935" class="CatchallClause Function">getPaymentOutput</a><a id="4753" class="CatchallClause"> </a><a id="4754" href="DEx.Model.html#4754" class="CatchallClause Bound">adr</a><a id="4757" class="CatchallClause"> </a><a id="4758" class="CatchallClause Keyword">record</a><a id="4764" class="CatchallClause"> </a><a id="4765" class="CatchallClause Symbol">{</a><a id="4766" class="CatchallClause"> </a><a id="4767" href="DEx.Model.html#2128" class="CatchallClause Field">txOutputs</a><a id="4776" class="CatchallClause"> </a><a id="4777" class="CatchallClause Symbol">=</a><a id="4778" class="CatchallClause"> </a><a id="4779" href="DEx.Model.html#4779" class="CatchallClause Bound">txOutputs</a><a id="4788" class="CatchallClause"> </a><a id="4789" class="CatchallClause Symbol">;</a><a id="4790" class="CatchallClause"> </a><a id="4791" href="DEx.Model.html#2161" class="CatchallClause Field">inputVal</a><a id="4799" class="CatchallClause"> </a><a id="4800" class="CatchallClause Symbol">=</a><a id="4801" class="CatchallClause"> </a><a id="4802" href="DEx.Model.html#4802" class="CatchallClause Bound">inputVal</a><a id="4810" class="CatchallClause"> </a><a id="4811" class="CatchallClause Symbol">;</a><a id="4812" class="CatchallClause"> </a><a id="4813" href="DEx.Model.html#2189" class="CatchallClause Field">inputAc</a><a id="4820" class="CatchallClause"> </a><a id="4821" class="CatchallClause Symbol">=</a><a id="4822" class="CatchallClause"> </a><a id="4823" href="DEx.Model.html#4823" class="CatchallClause Bound">inputAc</a>
                            <a id="4859" class="Symbol">;</a> <a id="4861" href="DEx.Model.html#2222" class="CatchallClause Field">signature</a><a id="4870" class="CatchallClause"> </a><a id="4871" class="CatchallClause Symbol">=</a><a id="4872" class="CatchallClause"> </a><a id="4873" href="DEx.Model.html#4873" class="CatchallClause Bound">signature</a><a id="4882" class="CatchallClause"> </a><a id="4883" class="CatchallClause Symbol">;</a><a id="4884" class="CatchallClause"> </a><a id="4885" href="DEx.Model.html#2255" class="CatchallClause Field">purpose</a><a id="4892" class="CatchallClause"> </a><a id="4893" class="CatchallClause Symbol">=</a><a id="4894" class="CatchallClause"> </a><a id="4895" class="CatchallClause Symbol">(</a><a id="4896" href="DEx.Model.html#1907" class="CatchallClause InductiveConstructor">Minting</a><a id="4903" class="CatchallClause"> </a><a id="4904" href="DEx.Model.html#4904" class="CatchallClause Bound">x</a><a id="4905" class="CatchallClause Symbol">)</a><a id="4906" class="CatchallClause"> </a><a id="4907" class="CatchallClause Symbol">}</a>
  <a id="4911" class="Symbol">=</a> <a id="4913" class="Keyword">record</a> <a id="4920" class="Symbol">{</a> <a id="4922" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="4935" class="Symbol">=</a> <a id="4937" class="Number">0</a> <a id="4939" class="Symbol">;</a> <a id="4941" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="4952" class="Symbol">=</a> <a id="4954" class="Keyword">record</a> <a id="4961" class="Symbol">{</a> <a id="4963" href="DEx.Model.html#177" class="Field">amount</a> <a id="4970" class="Symbol">=</a> <a id="4972" class="Number">-1</a> <a id="4975" class="Symbol">;</a> <a id="4977" href="DEx.Model.html#206" class="Field">currency</a> <a id="4986" class="Symbol">=</a> <a id="4988" class="Number">0</a> <a id="4990" class="Symbol">}</a>
           <a id="5003" class="Symbol">;</a> <a id="5005" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="5016" class="Symbol">=</a> <a id="5018" href="DEx.Model.html#1586" class="InductiveConstructor">Script</a> <a id="5025" class="Symbol">(</a><a id="5026" class="Keyword">record</a> <a id="5033" class="Symbol">{</a> <a id="5035" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="5041" class="Symbol">=</a> <a id="5043" class="Keyword">record</a> <a id="5050" class="Symbol">{</a> <a id="5052" href="DEx.Model.html#704" class="Field">num</a> <a id="5056" class="Symbol">=</a> <a id="5058" class="Number">0</a> <a id="5060" class="Symbol">;</a> <a id="5062" href="DEx.Model.html#731" class="Field">den</a> <a id="5066" class="Symbol">=</a> <a id="5068" class="Number">0</a> <a id="5070" class="Symbol">}</a> <a id="5072" class="Symbol">;</a> <a id="5074" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5080" class="Symbol">=</a> <a id="5082" class="Number">0</a> <a id="5084" class="Symbol">})</a> <a id="5087" class="Symbol">}</a>


<a id="getSelf&#39;"></a><a id="5091" href="DEx.Model.html#5091" class="Function">getSelf&#39;</a> <a id="5100" class="Symbol">:</a> <a id="5102" href="DEx.Model.html#1835" class="Datatype">ScriptPurpose</a> <a id="5116" class="Symbol">→</a> <a id="5118" href="DEx.Model.html#109" class="Function">Address</a>
<a id="5126" href="DEx.Model.html#5091" class="Function">getSelf&#39;</a> <a id="5135" href="DEx.Model.html#5135" class="Bound">p</a> <a id="5137" class="Symbol">=</a> <a id="5139" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="5144" href="DEx.Model.html#5135" class="Bound">p</a> <a id="5146" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="5149" class="Symbol">λ</a> <a id="5151" class="Keyword">where</a>
  <a id="5159" class="Symbol">(</a><a id="5160" href="DEx.Model.html#1907" class="InductiveConstructor">Minting</a> <a id="5168" href="DEx.Model.html#5168" class="Bound">cs</a><a id="5170" class="Symbol">)</a> <a id="5172" class="Symbol">→</a> <a id="5174" class="Number">0</a>
  <a id="5178" class="Symbol">(</a><a id="5179" href="DEx.Model.html#1863" class="InductiveConstructor">Spending</a> <a id="5188" href="DEx.Model.html#5188" class="Bound">adr</a><a id="5191" class="Symbol">)</a> <a id="5193" class="Symbol">→</a> <a id="5195" href="DEx.Model.html#5188" class="Bound">adr</a>

<a id="getSelf"></a><a id="5200" href="DEx.Model.html#5200" class="Function">getSelf</a> <a id="5208" class="Symbol">:</a> <a id="5210" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="5224" class="Symbol">→</a> <a id="5226" href="DEx.Model.html#109" class="Function">Address</a>
<a id="5234" href="DEx.Model.html#5200" class="Function">getSelf</a> <a id="5242" href="DEx.Model.html#5242" class="Bound">ctx</a> <a id="5246" class="Symbol">=</a> <a id="5248" href="DEx.Model.html#5091" class="Function">getSelf&#39;</a> <a id="5257" class="Symbol">(</a><a id="5258" href="DEx.Model.html#2255" class="Field">purpose</a> <a id="5266" href="DEx.Model.html#5242" class="Bound">ctx</a><a id="5269" class="Symbol">)</a>

<a id="checkPayment"></a><a id="5272" href="DEx.Model.html#5272" class="Function">checkPayment</a> <a id="5285" class="Symbol">:</a> <a id="5287" href="DEx.Model.html#2563" class="Record">Params</a> <a id="5294" class="Symbol">→</a> <a id="5296" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="5304" class="Symbol">→</a> <a id="5306" href="DEx.Model.html#1027" class="Record">Label</a> <a id="5312" class="Symbol">→</a> <a id="5314" href="DEx.Model.html#92" class="Function">PubKeyHash</a> <a id="5325" class="Symbol">→</a> <a id="5327" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="5341" class="Symbol">→</a> <a id="5343" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5348" href="DEx.Model.html#5272" class="Function">checkPayment</a> <a id="5361" href="DEx.Model.html#5361" class="Bound">par</a> <a id="5365" href="DEx.Model.html#5365" class="Bound">amt</a> <a id="5369" href="DEx.Model.html#5369" class="Bound">l</a> <a id="5371" href="DEx.Model.html#5371" class="Bound">pkh</a> <a id="5375" href="DEx.Model.html#5375" class="Bound">ctx</a>
  <a id="5381" class="Symbol">=</a>  <a id="5384" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="5397" class="Symbol">(</a><a id="5398" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5415" class="Symbol">(</a><a id="5416" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5422" href="DEx.Model.html#5369" class="Bound">l</a><a id="5423" class="Symbol">)</a> <a id="5425" href="DEx.Model.html#5375" class="Bound">ctx</a><a id="5428" class="Symbol">)</a> <a id="5430" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5433" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5439" href="DEx.Model.html#5369" class="Bound">l</a>
  <a id="5443" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5446" href="DEx.Model.html#3834" class="Function">ratioCompare</a> <a id="5459" href="DEx.Model.html#5365" class="Bound">amt</a> <a id="5463" class="Symbol">(</a><a id="5464" href="DEx.Model.html#177" class="Field">amount</a> <a id="5471" class="Symbol">(</a><a id="5472" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="5483" class="Symbol">(</a><a id="5484" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5501" class="Symbol">(</a><a id="5502" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5508" href="DEx.Model.html#5369" class="Bound">l</a><a id="5509" class="Symbol">)</a> <a id="5511" href="DEx.Model.html#5375" class="Bound">ctx</a><a id="5514" class="Symbol">)))</a> <a id="5518" class="Symbol">(</a><a id="5519" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="5525" href="DEx.Model.html#5369" class="Bound">l</a><a id="5526" class="Symbol">)</a>
  <a id="5530" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5533" href="DEx.Model.html#206" class="Field">currency</a> <a id="5542" class="Symbol">(</a><a id="5543" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="5554" class="Symbol">(</a><a id="5555" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5572" class="Symbol">(</a><a id="5573" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5579" href="DEx.Model.html#5369" class="Bound">l</a><a id="5580" class="Symbol">)</a> <a id="5582" href="DEx.Model.html#5375" class="Bound">ctx</a><a id="5585" class="Symbol">))</a> <a id="5588" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5591" href="DEx.Model.html#2621" class="Field">buyC</a> <a id="5596" href="DEx.Model.html#5361" class="Bound">par</a>
  <a id="5602" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5605" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="5616" class="Symbol">(</a><a id="5617" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5634" class="Symbol">(</a><a id="5635" href="DEx.Model.html#1079" class="Field">owner</a> <a id="5641" href="DEx.Model.html#5369" class="Bound">l</a><a id="5642" class="Symbol">)</a> <a id="5644" href="DEx.Model.html#5375" class="Bound">ctx</a><a id="5647" class="Symbol">)</a> <a id="5649" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5652" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="5660" class="Symbol">(</a><a id="5661" href="DEx.Model.html#5200" class="Function">getSelf</a> <a id="5669" href="DEx.Model.html#5375" class="Bound">ctx</a><a id="5672" class="Symbol">)</a>

<a id="5675" class="Symbol">{-#</a> <a id="5679" class="Keyword">COMPILE</a> <a id="5687" class="Keyword">AGDA2HS</a> <a id="5695" href="DEx.Model.html#5272" class="Function">checkPayment</a> <a id="5708" class="Symbol">#-}</a>

<a id="checkBuyer"></a><a id="5713" href="DEx.Model.html#5713" class="Function">checkBuyer</a> <a id="5724" class="Symbol">:</a> <a id="5726" href="DEx.Model.html#2563" class="Record">Params</a> <a id="5733" class="Symbol">→</a> <a id="5735" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="5743" class="Symbol">→</a> <a id="5745" href="DEx.Model.html#92" class="Function">PubKeyHash</a> <a id="5756" class="Symbol">→</a> <a id="5758" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="5772" class="Symbol">→</a> <a id="5774" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5779" href="DEx.Model.html#5713" class="Function">checkBuyer</a> <a id="5790" href="DEx.Model.html#5790" class="Bound">par</a> <a id="5794" href="DEx.Model.html#5794" class="Bound">amt</a> <a id="5798" href="DEx.Model.html#5798" class="Bound">pkh</a> <a id="5802" href="DEx.Model.html#5802" class="Bound">ctx</a>
  <a id="5808" class="Symbol">=</a> <a id="5810" href="DEx.Model.html#1983" class="Field">txOutAddress</a> <a id="5823" class="Symbol">(</a><a id="5824" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5841" href="DEx.Model.html#5798" class="Bound">pkh</a> <a id="5845" href="DEx.Model.html#5802" class="Bound">ctx</a><a id="5848" class="Symbol">)</a> <a id="5850" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5853" href="DEx.Model.html#5798" class="Bound">pkh</a>
  <a id="5859" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5862" class="Symbol">(</a><a id="5863" href="DEx.Model.html#2014" class="Field">txOutValue</a> <a id="5874" class="Symbol">(</a><a id="5875" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5892" href="DEx.Model.html#5798" class="Bound">pkh</a> <a id="5896" href="DEx.Model.html#5802" class="Bound">ctx</a><a id="5899" class="Symbol">))</a> <a id="5902" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5905" class="Keyword">record</a> <a id="5912" class="Symbol">{</a> <a id="5914" href="DEx.Model.html#177" class="Field">amount</a> <a id="5921" class="Symbol">=</a> <a id="5923" href="DEx.Model.html#5794" class="Bound">amt</a> <a id="5927" class="Symbol">;</a> <a id="5929" href="DEx.Model.html#206" class="Field">currency</a> <a id="5938" class="Symbol">=</a> <a id="5940" href="DEx.Model.html#2592" class="Field">sellC</a> <a id="5946" href="DEx.Model.html#5790" class="Bound">par</a> <a id="5950" class="Symbol">}</a>
  <a id="5954" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5957" href="DEx.Model.html#2041" class="Field">txOutDatum</a> <a id="5968" class="Symbol">(</a><a id="5969" href="DEx.Model.html#3935" class="Function">getPaymentOutput</a> <a id="5986" href="DEx.Model.html#5798" class="Bound">pkh</a> <a id="5990" href="DEx.Model.html#5802" class="Bound">ctx</a><a id="5993" class="Symbol">)</a> <a id="5995" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5998" href="DEx.Model.html#1552" class="InductiveConstructor">Payment</a> <a id="6006" class="Symbol">(</a><a id="6007" href="DEx.Model.html#5200" class="Function">getSelf</a> <a id="6015" href="DEx.Model.html#5802" class="Bound">ctx</a><a id="6018" class="Symbol">)</a>

<a id="6021" class="Symbol">{-#</a> <a id="6025" class="Keyword">COMPILE</a> <a id="6033" class="Keyword">AGDA2HS</a> <a id="6041" href="DEx.Model.html#5713" class="Function">checkBuyer</a> <a id="6052" class="Symbol">#-}</a>

<a id="agdaValidator"></a><a id="6057" href="DEx.Model.html#6057" class="Function">agdaValidator</a> <a id="6071" class="Symbol">:</a> <a id="6073" href="DEx.Model.html#2563" class="Record">Params</a> <a id="6080" class="Symbol">→</a> <a id="6082" href="DEx.Model.html#1027" class="Record">Label</a> <a id="6088" class="Symbol">→</a> <a id="6090" href="DEx.Model.html#2405" class="Datatype">Input</a> <a id="6096" class="Symbol">→</a> <a id="6098" href="DEx.Model.html#2092" class="Record">ScriptContext</a> <a id="6112" class="Symbol">→</a> <a id="6114" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6119" href="DEx.Model.html#6057" class="Function">agdaValidator</a> <a id="6133" href="DEx.Model.html#6133" class="Bound">par</a> <a id="6137" href="DEx.Model.html#6137" class="Bound">l</a> <a id="6139" href="DEx.Model.html#6139" class="Bound">red</a> <a id="6143" href="DEx.Model.html#6143" class="Bound">ctx</a> <a id="6147" class="Symbol">=</a> <a id="6149" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="6154" href="DEx.Model.html#6139" class="Bound">red</a> <a id="6158" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="6161" class="Symbol">λ</a> <a id="6163" class="Keyword">where</a>
  <a id="6171" class="Symbol">(</a><a id="6172" href="DEx.Model.html#2425" class="InductiveConstructor">Update</a> <a id="6179" href="DEx.Model.html#6179" class="Bound">amt</a> <a id="6183" href="DEx.Model.html#6183" class="Bound">r</a><a id="6184" class="Symbol">)</a>     <a id="6190" class="Symbol">→</a> <a id="6192" href="DEx.Model.html#2308" class="Function">checkSigned</a> <a id="6204" class="Symbol">(</a><a id="6205" href="DEx.Model.html#1079" class="Field">owner</a> <a id="6211" href="DEx.Model.html#6137" class="Bound">l</a><a id="6212" class="Symbol">)</a> <a id="6214" href="DEx.Model.html#6143" class="Bound">ctx</a>
                    <a id="6238" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6241" href="DEx.Model.html#878" class="Function">checkRational</a> <a id="6255" href="DEx.Model.html#6183" class="Bound">r</a>
                    <a id="6277" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6280" href="DEx.Model.html#3551" class="Function">newValue</a> <a id="6289" href="DEx.Model.html#6143" class="Bound">ctx</a> <a id="6293" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6296" class="Keyword">record</a> <a id="6303" class="Symbol">{</a> <a id="6305" href="DEx.Model.html#177" class="Field">amount</a> <a id="6312" class="Symbol">=</a> <a id="6314" href="DEx.Model.html#6179" class="Bound">amt</a> <a id="6318" class="Symbol">;</a> <a id="6320" href="DEx.Model.html#206" class="Field">currency</a> <a id="6329" class="Symbol">=</a> <a id="6331" href="DEx.Model.html#2592" class="Field">sellC</a> <a id="6337" href="DEx.Model.html#6133" class="Bound">par</a> <a id="6341" class="Symbol">}</a>
                    <a id="6363" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6366" href="DEx.Model.html#3376" class="Function">newLabel</a> <a id="6375" href="DEx.Model.html#6143" class="Bound">ctx</a> <a id="6379" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6382" class="Symbol">(</a><a id="6383" class="Keyword">record</a> <a id="6390" class="Symbol">{</a><a id="6391" href="DEx.Model.html#1053" class="Field">ratio</a> <a id="6397" class="Symbol">=</a> <a id="6399" href="DEx.Model.html#6183" class="Bound">r</a> <a id="6401" class="Symbol">;</a> <a id="6403" href="DEx.Model.html#1079" class="Field">owner</a> <a id="6409" class="Symbol">=</a> <a id="6411" href="DEx.Model.html#1079" class="Field">owner</a> <a id="6417" href="DEx.Model.html#6137" class="Bound">l</a><a id="6418" class="Symbol">})</a>
                    <a id="6441" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6444" href="DEx.Model.html#3743" class="Function">continuing</a> <a id="6455" href="DEx.Model.html#6143" class="Bound">ctx</a>
  <a id="6461" class="Symbol">(</a><a id="6462" href="DEx.Model.html#2465" class="InductiveConstructor">Exchange</a> <a id="6471" href="DEx.Model.html#6471" class="Bound">amt</a> <a id="6475" href="DEx.Model.html#6475" class="Bound">pkh</a><a id="6478" class="Symbol">)</a> <a id="6480" class="Symbol">→</a> <a id="6482" href="DEx.Model.html#3314" class="Function">oldValue</a> <a id="6491" href="DEx.Model.html#6143" class="Bound">ctx</a> <a id="6495" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6498" class="Symbol">(</a><a id="6499" href="DEx.Model.html#3551" class="Function">newValue</a> <a id="6508" href="DEx.Model.html#6143" class="Bound">ctx</a><a id="6511" class="Symbol">)</a> <a id="6513" href="Haskell.Prim.Monoid.html#344" class="Field Operator">&lt;&gt;</a> <a id="6516" class="Keyword">record</a> <a id="6523" class="Symbol">{</a> <a id="6525" href="DEx.Model.html#177" class="Field">amount</a> <a id="6532" class="Symbol">=</a> <a id="6534" href="DEx.Model.html#6471" class="Bound">amt</a> <a id="6538" class="Symbol">;</a> <a id="6540" href="DEx.Model.html#206" class="Field">currency</a> <a id="6549" class="Symbol">=</a> <a id="6551" href="DEx.Model.html#2592" class="Field">sellC</a> <a id="6557" href="DEx.Model.html#6133" class="Bound">par</a> <a id="6561" class="Symbol">}</a>
                    <a id="6583" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6586" href="DEx.Model.html#3376" class="Function">newLabel</a> <a id="6595" href="DEx.Model.html#6143" class="Bound">ctx</a> <a id="6599" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6602" href="DEx.Model.html#6137" class="Bound">l</a>
                    <a id="6624" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6627" href="DEx.Model.html#5272" class="Function">checkPayment</a> <a id="6640" href="DEx.Model.html#6133" class="Bound">par</a> <a id="6644" href="DEx.Model.html#6471" class="Bound">amt</a> <a id="6648" href="DEx.Model.html#6137" class="Bound">l</a> <a id="6650" href="DEx.Model.html#6475" class="Bound">pkh</a> <a id="6654" href="DEx.Model.html#6143" class="Bound">ctx</a>
                    <a id="6678" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6681" href="DEx.Model.html#5713" class="Function">checkBuyer</a> <a id="6692" href="DEx.Model.html#6133" class="Bound">par</a> <a id="6696" href="DEx.Model.html#6471" class="Bound">amt</a> <a id="6700" href="DEx.Model.html#6475" class="Bound">pkh</a> <a id="6704" href="DEx.Model.html#6143" class="Bound">ctx</a>
                    <a id="6728" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6731" href="DEx.Model.html#3743" class="Function">continuing</a> <a id="6742" href="DEx.Model.html#6143" class="Bound">ctx</a>
  <a id="6748" href="DEx.Model.html#2507" class="InductiveConstructor">Close</a>              <a id="6767" class="Symbol">→</a> <a id="6769" href="Haskell.Prim.Bool.html#273" class="Function">not</a> <a id="6773" class="Symbol">(</a><a id="6774" href="DEx.Model.html#3743" class="Function">continuing</a> <a id="6785" href="DEx.Model.html#6143" class="Bound">ctx</a><a id="6788" class="Symbol">)</a>
                    <a id="6810" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="6813" href="DEx.Model.html#2308" class="Function">checkSigned</a> <a id="6825" class="Symbol">(</a><a id="6826" href="DEx.Model.html#1079" class="Field">owner</a> <a id="6832" href="DEx.Model.html#6137" class="Bound">l</a><a id="6833" class="Symbol">)</a> <a id="6835" href="DEx.Model.html#6143" class="Bound">ctx</a>

<a id="6840" class="Symbol">{-#</a> <a id="6844" class="Keyword">COMPILE</a> <a id="6852" class="Keyword">AGDA2HS</a> <a id="6860" href="DEx.Model.html#6057" class="Function">agdaValidator</a> <a id="6874" class="Symbol">#-}</a>
</pre></body></html>