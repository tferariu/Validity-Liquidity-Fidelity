<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>DEx</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/tferariu/Validity-Liquidity-Fidelity/tree/main///DEx.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="DEx.html" class="Module">DEx</a> <a id="12" class="Keyword">where</a>

<a id="19" class="Keyword">open</a> <a id="24" class="Keyword">import</a> <a id="31" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a>

<a id="Placeholder"></a><a id="48" href="DEx.html#48" class="Function">Placeholder</a> <a id="60" class="Symbol">=</a> <a id="62" href="Haskell.Prim.String.html#344" class="Function">String</a>
<a id="POSIXTimeRange"></a><a id="69" href="DEx.html#69" class="Function">POSIXTimeRange</a> <a id="84" class="Symbol">=</a> <a id="86" href="DEx.html#48" class="Function">Placeholder</a>
<a id="ThreadToken"></a><a id="98" href="DEx.html#98" class="Function">ThreadToken</a> <a id="110" class="Symbol">=</a> <a id="112" href="DEx.html#48" class="Function">Placeholder</a>

<a id="CurrencySymbol"></a><a id="125" href="DEx.html#125" class="Function">CurrencySymbol</a> <a id="140" class="Symbol">=</a> <a id="142" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
<a id="TokenName"></a><a id="146" href="DEx.html#146" class="Function">TokenName</a> <a id="156" class="Symbol">=</a> <a id="158" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="PubKeyHash"></a><a id="163" href="DEx.html#163" class="Function">PubKeyHash</a> <a id="174" class="Symbol">=</a> <a id="176" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> 
<a id="Address"></a><a id="181" href="DEx.html#181" class="Function">Address</a> <a id="189" class="Symbol">=</a> <a id="191" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="AssetClass"></a><a id="196" href="DEx.html#196" class="Function">AssetClass</a> <a id="207" class="Symbol">=</a> <a id="209" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="214" class="Keyword">record</a> <a id="Value"></a><a id="221" href="DEx.html#221" class="Record">Value</a> <a id="227" class="Symbol">:</a> <a id="229" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="233" class="Keyword">where</a>
    <a id="243" class="Keyword">field</a>
            <a id="Value.amount"></a><a id="261" href="DEx.html#261" class="Field">amount</a>   <a id="270" class="Symbol">:</a> <a id="272" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
            <a id="Value.currency"></a><a id="292" href="DEx.html#292" class="Field">currency</a> <a id="301" class="Symbol">:</a> <a id="303" href="DEx.html#196" class="Function">AssetClass</a>
<a id="314" class="Keyword">open</a> <a id="319" href="DEx.html#221" class="Module">Value</a> <a id="325" class="Keyword">public</a>


<a id="addValue"></a><a id="334" href="DEx.html#334" class="Function">addValue</a> <a id="343" class="Symbol">:</a> <a id="345" href="DEx.html#221" class="Record">Value</a> <a id="351" class="Symbol">-&gt;</a> <a id="354" href="DEx.html#221" class="Record">Value</a> <a id="360" class="Symbol">-&gt;</a> <a id="363" href="DEx.html#221" class="Record">Value</a>
<a id="369" href="DEx.html#334" class="Function">addValue</a> <a id="378" href="DEx.html#378" class="Bound">a</a> <a id="380" href="DEx.html#380" class="Bound">b</a> <a id="382" class="Symbol">=</a> <a id="384" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="389" href="DEx.html#292" class="Field">currency</a> <a id="398" href="DEx.html#378" class="Bound">a</a> <a id="400" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="403" href="DEx.html#292" class="Field">currency</a> <a id="412" href="DEx.html#380" class="Bound">b</a> <a id="414" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="417" class="Symbol">λ</a> <a id="419" class="Keyword">where</a>
  <a id="427" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a> <a id="432" class="Symbol">-&gt;</a> <a id="435" class="Keyword">record</a> <a id="442" class="Symbol">{</a> <a id="444" href="DEx.html#261" class="Field">amount</a> <a id="451" class="Symbol">=</a> <a id="453" href="DEx.html#261" class="Field">amount</a> <a id="460" href="DEx.html#378" class="Bound">a</a> <a id="462" href="Haskell.Prim.Num.html#547" class="Field Operator">+</a> <a id="464" href="DEx.html#261" class="Field">amount</a> <a id="471" href="DEx.html#380" class="Bound">b</a> <a id="473" class="Symbol">;</a> <a id="475" href="DEx.html#292" class="Field">currency</a> <a id="484" class="Symbol">=</a> <a id="486" href="DEx.html#292" class="Field">currency</a> <a id="495" href="DEx.html#378" class="Bound">a</a> <a id="497" class="Symbol">}</a>
  <a id="501" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="507" class="Symbol">-&gt;</a> <a id="510" href="DEx.html#378" class="Bound">a</a>


<a id="eqValue"></a><a id="514" href="DEx.html#514" class="Function">eqValue</a> <a id="522" class="Symbol">:</a> <a id="524" href="DEx.html#221" class="Record">Value</a> <a id="530" class="Symbol">-&gt;</a> <a id="533" href="DEx.html#221" class="Record">Value</a> <a id="539" class="Symbol">-&gt;</a> <a id="542" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="547" href="DEx.html#514" class="Function">eqValue</a> <a id="555" href="DEx.html#555" class="Bound">a</a> <a id="557" href="DEx.html#557" class="Bound">b</a> <a id="559" class="Symbol">=</a> <a id="561" class="Symbol">(</a><a id="562" href="DEx.html#261" class="Field">amount</a> <a id="569" href="DEx.html#555" class="Bound">a</a> <a id="571" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="574" href="DEx.html#261" class="Field">amount</a> <a id="581" href="DEx.html#557" class="Bound">b</a><a id="582" class="Symbol">)</a> <a id="584" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
              <a id="601" class="Symbol">(</a><a id="602" href="DEx.html#292" class="Field">currency</a> <a id="611" href="DEx.html#555" class="Bound">a</a> <a id="613" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="616" href="DEx.html#292" class="Field">currency</a> <a id="625" href="DEx.html#557" class="Bound">b</a><a id="626" class="Symbol">)</a> 

<a id="630" class="Keyword">instance</a>
  <a id="iEqValue"></a><a id="641" href="DEx.html#641" class="Function">iEqValue</a> <a id="650" class="Symbol">:</a> <a id="652" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="655" href="DEx.html#221" class="Record">Value</a>
  <a id="663" href="DEx.html#641" class="Function">iEqValue</a> <a id="672" class="Symbol">.</a><a id="673" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="678" class="Symbol">=</a> <a id="680" href="DEx.html#514" class="Function">eqValue</a>
  
  <a id="iSemigroupValue"></a><a id="693" href="DEx.html#693" class="Function">iSemigroupValue</a> <a id="709" class="Symbol">:</a> <a id="711" href="Haskell.Prim.Monoid.html#288" class="Record">Semigroup</a> <a id="721" href="DEx.html#221" class="Record">Value</a>
  <a id="729" href="DEx.html#693" class="Function">iSemigroupValue</a> <a id="745" class="Symbol">.</a><a id="746" href="Haskell.Prim.Monoid.html#344" class="Field Operator">_&lt;&gt;_</a> <a id="751" class="Symbol">=</a> <a id="753" href="DEx.html#334" class="Function">addValue</a>


<a id="764" class="Keyword">record</a> <a id="Rational"></a><a id="771" href="DEx.html#771" class="Record">Rational</a> <a id="780" class="Symbol">:</a> <a id="782" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="786" class="Keyword">where</a>
    <a id="796" class="Keyword">field</a>
        <a id="Rational.num"></a><a id="810" href="DEx.html#810" class="Field">num</a>    <a id="817" class="Symbol">:</a> <a id="819" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
        <a id="Rational.den"></a><a id="835" href="DEx.html#835" class="Field">den</a>    <a id="842" class="Symbol">:</a> <a id="844" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="852" class="Keyword">open</a> <a id="857" href="DEx.html#771" class="Module">Rational</a> <a id="866" class="Keyword">public</a>

<a id="numerator"></a><a id="874" href="DEx.html#874" class="Function">numerator</a> <a id="884" class="Symbol">:</a> <a id="886" href="DEx.html#771" class="Record">Rational</a> <a id="895" class="Symbol">-&gt;</a> <a id="898" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="906" href="DEx.html#874" class="Function">numerator</a> <a id="916" href="DEx.html#916" class="Bound">r</a> <a id="918" class="Symbol">=</a> <a id="920" href="DEx.html#810" class="Field">num</a> <a id="924" href="DEx.html#916" class="Bound">r</a>

<a id="denominator"></a><a id="927" href="DEx.html#927" class="Function">denominator</a> <a id="939" class="Symbol">:</a> <a id="941" href="DEx.html#771" class="Record">Rational</a> <a id="950" class="Symbol">-&gt;</a> <a id="953" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a>
<a id="961" href="DEx.html#927" class="Function">denominator</a> <a id="973" href="DEx.html#973" class="Bound">r</a> <a id="975" class="Symbol">=</a> <a id="977" href="DEx.html#835" class="Field">den</a> <a id="981" href="DEx.html#973" class="Bound">r</a>

<a id="checkRational"></a><a id="984" href="DEx.html#984" class="Function">checkRational</a> <a id="998" class="Symbol">:</a> <a id="1000" href="DEx.html#771" class="Record">Rational</a> <a id="1009" class="Symbol">-&gt;</a> <a id="1012" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1017" href="DEx.html#984" class="Function">checkRational</a> <a id="1031" href="DEx.html#1031" class="Bound">r</a> <a id="1033" class="Symbol">=</a> <a id="1035" class="Symbol">(</a><a id="1036" href="DEx.html#874" class="Function">numerator</a> <a id="1046" href="DEx.html#1031" class="Bound">r</a> <a id="1048" href="Haskell.Prim.Ord.html#1120" class="Field Operator">&gt;=</a> <a id="1051" class="Number">0</a><a id="1052" class="Symbol">)</a> <a id="1054" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="1057" class="Symbol">(</a><a id="1058" href="DEx.html#927" class="Function">denominator</a> <a id="1070" href="DEx.html#1031" class="Bound">r</a> <a id="1072" href="Haskell.Prim.Ord.html#1096" class="Field Operator">&gt;</a> <a id="1074" class="Number">0</a><a id="1075" class="Symbol">)</a>

<a id="Cmap"></a><a id="1078" href="DEx.html#1078" class="Function">Cmap</a> <a id="1083" class="Symbol">=</a> <a id="1085" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1090" class="Symbol">((</a><a id="1092" href="DEx.html#771" class="Record">Rational</a> <a id="1101" href="Haskell.Prim.Tuple.html#169" class="Record Operator">×</a> <a id="1103" href="DEx.html#163" class="Function">PubKeyHash</a><a id="1113" class="Symbol">)</a> <a id="1115" href="Haskell.Prim.Tuple.html#169" class="Record Operator">×</a> <a id="1117" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a><a id="1124" class="Symbol">)</a>

<a id="1127" class="Keyword">record</a> <a id="Label"></a><a id="1134" href="DEx.html#1134" class="Record">Label</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1146" class="Keyword">where</a>
  <a id="1154" class="Keyword">field</a>
    <a id="Label.ratio"></a><a id="1164" href="DEx.html#1164" class="Field">ratio</a>  <a id="1171" class="Symbol">:</a> <a id="1173" href="DEx.html#771" class="Record">Rational</a>
    <a id="Label.owner"></a><a id="1186" href="DEx.html#1186" class="Field">owner</a>  <a id="1193" class="Symbol">:</a> <a id="1195" href="DEx.html#163" class="Function">PubKeyHash</a>
<a id="1206" class="Keyword">open</a> <a id="1211" href="DEx.html#1134" class="Module">Label</a> <a id="1217" class="Keyword">public</a>

<a id="1225" class="Symbol">{-#</a> <a id="1229" class="Keyword">COMPILE</a> <a id="1237" class="Keyword">AGDA2HS</a> <a id="1245" href="DEx.html#1134" class="Record">Label</a> <a id="1251" class="Symbol">#-}</a>

<a id="eqRational"></a><a id="1256" href="DEx.html#1256" class="Function">eqRational</a> <a id="1267" class="Symbol">:</a> <a id="1269" href="DEx.html#771" class="Record">Rational</a> <a id="1278" class="Symbol">-&gt;</a> <a id="1281" href="DEx.html#771" class="Record">Rational</a> <a id="1290" class="Symbol">-&gt;</a> <a id="1293" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1298" href="DEx.html#1256" class="Function">eqRational</a> <a id="1309" href="DEx.html#1309" class="Bound">b</a> <a id="1311" href="DEx.html#1311" class="Bound">c</a> <a id="1313" class="Symbol">=</a> <a id="1315" class="Symbol">(</a><a id="1316" href="DEx.html#810" class="Field">num</a> <a id="1320" href="DEx.html#1309" class="Bound">b</a> <a id="1322" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1325" href="DEx.html#810" class="Field">num</a> <a id="1329" href="DEx.html#1311" class="Bound">c</a><a id="1330" class="Symbol">)</a> <a id="1332" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                 <a id="1352" class="Symbol">(</a><a id="1353" href="DEx.html#835" class="Field">den</a> <a id="1357" href="DEx.html#1309" class="Bound">b</a> <a id="1359" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1362" href="DEx.html#835" class="Field">den</a> <a id="1366" href="DEx.html#1311" class="Bound">c</a><a id="1367" class="Symbol">)</a> 


<a id="ltRational"></a><a id="1372" href="DEx.html#1372" class="Function">ltRational</a> <a id="1383" class="Symbol">:</a> <a id="1385" href="DEx.html#771" class="Record">Rational</a> <a id="1394" class="Symbol">-&gt;</a> <a id="1397" href="DEx.html#771" class="Record">Rational</a> <a id="1406" class="Symbol">-&gt;</a> <a id="1409" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1414" href="DEx.html#1372" class="Function">ltRational</a> <a id="1425" href="DEx.html#1425" class="Bound">b</a> <a id="1427" href="DEx.html#1427" class="Bound">c</a> <a id="1429" class="Symbol">=</a> <a id="1431" href="DEx.html#810" class="Field">num</a> <a id="1435" href="DEx.html#1425" class="Bound">b</a> <a id="1437" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="1439" href="DEx.html#835" class="Field">den</a> <a id="1443" href="DEx.html#1427" class="Bound">c</a> <a id="1445" href="Haskell.Prim.Ord.html#1072" class="Field Operator">&lt;</a> <a id="1447" href="DEx.html#810" class="Field">num</a> <a id="1451" href="DEx.html#1427" class="Bound">c</a> <a id="1453" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="1455" href="DEx.html#835" class="Field">den</a> <a id="1459" href="DEx.html#1425" class="Bound">b</a>


<a id="1463" class="Keyword">instance</a>
  <a id="iEqRational"></a><a id="1474" href="DEx.html#1474" class="Function">iEqRational</a> <a id="1486" class="Symbol">:</a> <a id="1488" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1491" href="DEx.html#771" class="Record">Rational</a>
  <a id="1502" href="DEx.html#1474" class="Function">iEqRational</a> <a id="1514" class="Symbol">.</a><a id="1515" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1520" class="Symbol">=</a> <a id="1522" href="DEx.html#1256" class="Function">eqRational</a>

<a id="eqLabel"></a><a id="1534" href="DEx.html#1534" class="Function">eqLabel</a> <a id="1542" class="Symbol">:</a> <a id="1544" href="DEx.html#1134" class="Record">Label</a> <a id="1550" class="Symbol">-&gt;</a> <a id="1553" href="DEx.html#1134" class="Record">Label</a> <a id="1559" class="Symbol">-&gt;</a> <a id="1562" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1567" href="DEx.html#1534" class="Function">eqLabel</a> <a id="1575" href="DEx.html#1575" class="Bound">b</a> <a id="1577" href="DEx.html#1577" class="Bound">c</a> <a id="1579" class="Symbol">=</a> <a id="1581" class="Symbol">(</a><a id="1582" href="DEx.html#1164" class="Field">ratio</a> <a id="1588" href="DEx.html#1575" class="Bound">b</a> <a id="1590" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1593" href="DEx.html#1164" class="Field">ratio</a> <a id="1599" href="DEx.html#1577" class="Bound">c</a><a id="1600" class="Symbol">)</a> <a id="1602" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
              <a id="1619" class="Symbol">(</a><a id="1620" href="DEx.html#1186" class="Field">owner</a> <a id="1626" href="DEx.html#1575" class="Bound">b</a> <a id="1628" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1631" href="DEx.html#1186" class="Field">owner</a> <a id="1637" href="DEx.html#1577" class="Bound">c</a><a id="1638" class="Symbol">)</a>


<a id="1642" class="Keyword">instance</a>
  <a id="iEqLabel"></a><a id="1653" href="DEx.html#1653" class="Function">iEqLabel</a> <a id="1662" class="Symbol">:</a> <a id="1664" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1667" href="DEx.html#1134" class="Record">Label</a>
  <a id="1675" href="DEx.html#1653" class="Function">iEqLabel</a> <a id="1684" class="Symbol">.</a><a id="1685" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1690" class="Symbol">=</a> <a id="1692" href="DEx.html#1534" class="Function">eqLabel</a>


<a id="1702" class="Keyword">data</a> <a id="OutputDatum"></a><a id="1707" href="DEx.html#1707" class="Datatype">OutputDatum</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1725" class="Keyword">where</a>

  <a id="OutputDatum.Payment"></a><a id="1734" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="1742" class="Symbol">:</a> <a id="1744" href="DEx.html#181" class="Function">Address</a> <a id="1752" class="Symbol">-&gt;</a> <a id="1755" href="DEx.html#1707" class="Datatype">OutputDatum</a>
  <a id="OutputDatum.Script"></a><a id="1769" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="1776" class="Symbol">:</a> <a id="1778" href="DEx.html#1134" class="Record">Label</a> <a id="1784" class="Symbol">-&gt;</a> <a id="1787" href="DEx.html#1707" class="Datatype">OutputDatum</a>


<a id="eqDatum"></a><a id="1801" href="DEx.html#1801" class="Function">eqDatum</a> <a id="1809" class="Symbol">:</a> <a id="1811" href="DEx.html#1707" class="Datatype">OutputDatum</a> <a id="1823" class="Symbol">-&gt;</a> <a id="1826" href="DEx.html#1707" class="Datatype">OutputDatum</a> <a id="1838" class="Symbol">-&gt;</a> <a id="1841" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1846" href="DEx.html#1801" class="Function">eqDatum</a> <a id="1854" class="Symbol">(</a><a id="1855" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="1863" href="DEx.html#1863" class="Bound">x</a><a id="1864" class="Symbol">)</a> <a id="1866" class="Symbol">(</a><a id="1867" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="1875" href="DEx.html#1875" class="Bound">y</a><a id="1876" class="Symbol">)</a> <a id="1878" class="Symbol">=</a> <a id="1880" href="DEx.html#1863" class="Bound">x</a> <a id="1882" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1885" href="DEx.html#1875" class="Bound">y</a>
<a id="1887" href="DEx.html#1801" class="Function">eqDatum</a> <a id="1895" class="Symbol">(</a><a id="1896" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="1904" href="DEx.html#1904" class="Bound">x</a><a id="1905" class="Symbol">)</a> <a id="1907" class="Symbol">(</a><a id="1908" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="1915" href="DEx.html#1915" class="Bound">y</a><a id="1916" class="Symbol">)</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a>
<a id="1926" href="DEx.html#1801" class="Function">eqDatum</a> <a id="1934" class="Symbol">(</a><a id="1935" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="1942" href="DEx.html#1942" class="Bound">x</a><a id="1943" class="Symbol">)</a> <a id="1945" class="Symbol">(</a><a id="1946" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="1954" href="DEx.html#1954" class="Bound">y</a><a id="1955" class="Symbol">)</a> <a id="1957" class="Symbol">=</a> <a id="1959" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a>
<a id="1965" href="DEx.html#1801" class="Function">eqDatum</a> <a id="1973" class="Symbol">(</a><a id="1974" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="1981" href="DEx.html#1981" class="Bound">x</a><a id="1982" class="Symbol">)</a> <a id="1984" class="Symbol">(</a><a id="1985" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="1992" href="DEx.html#1992" class="Bound">y</a><a id="1993" class="Symbol">)</a> <a id="1995" class="Symbol">=</a> <a id="1997" href="DEx.html#1981" class="Bound">x</a> <a id="1999" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="2002" href="DEx.html#1992" class="Bound">y</a>

<a id="2005" class="Keyword">instance</a>
  <a id="iEqDatum"></a><a id="2016" href="DEx.html#2016" class="Function">iEqDatum</a> <a id="2025" class="Symbol">:</a> <a id="2027" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2030" href="DEx.html#1707" class="Datatype">OutputDatum</a>
  <a id="2044" href="DEx.html#2016" class="Function">iEqDatum</a> <a id="2053" class="Symbol">.</a><a id="2054" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2059" class="Symbol">=</a> <a id="2061" href="DEx.html#1801" class="Function">eqDatum</a>

<a id="2070" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="2075" href="DEx.html#2075" class="Datatype">ScriptPurpose</a> <a id="2089" class="Symbol">:</a> <a id="2091" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2095" class="Keyword">where</a>

  <a id="ScriptPurpose.Spending"></a><a id="2104" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="2113" class="Symbol">:</a> <a id="2115" href="DEx.html#181" class="Function">Address</a> <a id="2123" class="Symbol">-&gt;</a> <a id="2126" href="DEx.html#2075" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Minting"></a><a id="2142" href="DEx.html#2142" class="InductiveConstructor">Minting</a> <a id="2150" class="Symbol">:</a> <a id="2152" href="DEx.html#125" class="Function">CurrencySymbol</a> <a id="2167" class="Symbol">-&gt;</a> <a id="2170" href="DEx.html#2075" class="Datatype">ScriptPurpose</a>

<a id="2185" class="Keyword">record</a> <a id="TxOut"></a><a id="2192" href="DEx.html#2192" class="Record">TxOut</a> <a id="2198" class="Symbol">:</a> <a id="2200" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2204" class="Keyword">where</a>
  <a id="2212" class="Keyword">field</a>
    <a id="TxOut.txOutAddress"></a><a id="2222" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="2235" class="Symbol">:</a> <a id="2237" href="DEx.html#181" class="Function">Address</a>
    <a id="TxOut.txOutValue"></a><a id="2249" href="DEx.html#2249" class="Field">txOutValue</a> <a id="2260" class="Symbol">:</a> <a id="2262" href="DEx.html#221" class="Record">Value</a>
    <a id="TxOut.txOutDatum"></a><a id="2272" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="2283" class="Symbol">:</a> <a id="2285" href="DEx.html#1707" class="Datatype">OutputDatum</a>

<a id="2298" class="Keyword">open</a> <a id="2303" href="DEx.html#2192" class="Module">TxOut</a> <a id="2309" class="Keyword">public</a>


<a id="2318" class="Keyword">record</a> <a id="ScriptContext"></a><a id="2325" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="2339" class="Symbol">:</a> <a id="2341" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2345" class="Keyword">where</a>
    <a id="2355" class="Keyword">field</a>
        <a id="ScriptContext.txOutputs"></a><a id="2369" href="DEx.html#2369" class="Field">txOutputs</a>   <a id="2381" class="Symbol">:</a> <a id="2383" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2388" href="DEx.html#2192" class="Record">TxOut</a>
        <a id="ScriptContext.inputVal"></a><a id="2402" href="DEx.html#2402" class="Field">inputVal</a>    <a id="2414" class="Symbol">:</a> <a id="2416" href="DEx.html#221" class="Record">Value</a>
        <a id="ScriptContext.inputAc"></a><a id="2430" href="DEx.html#2430" class="Field">inputAc</a>     <a id="2442" class="Symbol">:</a> <a id="2444" href="DEx.html#196" class="Function">AssetClass</a>
        <a id="ScriptContext.signature"></a><a id="2463" href="DEx.html#2463" class="Field">signature</a>   <a id="2475" class="Symbol">:</a> <a id="2477" href="DEx.html#163" class="Function">PubKeyHash</a>
        <a id="ScriptContext.purpose"></a><a id="2496" href="DEx.html#2496" class="Field">purpose</a>     <a id="2508" class="Symbol">:</a> <a id="2510" href="DEx.html#2075" class="Datatype">ScriptPurpose</a>
        
        
<a id="2542" class="Keyword">open</a> <a id="2547" href="DEx.html#2325" class="Module">ScriptContext</a> <a id="2561" class="Keyword">public</a>


<a id="checkSigned"></a><a id="2570" href="DEx.html#2570" class="Function">checkSigned</a> <a id="2582" class="Symbol">:</a> <a id="2584" href="DEx.html#163" class="Function">PubKeyHash</a> <a id="2595" class="Symbol">-&gt;</a> <a id="2598" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="2612" class="Symbol">-&gt;</a> <a id="2615" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="2620" href="DEx.html#2570" class="Function">checkSigned</a> <a id="2632" href="DEx.html#2632" class="Bound">sig</a> <a id="2636" href="DEx.html#2636" class="Bound">ctx</a> <a id="2640" class="Symbol">=</a> <a id="2642" href="DEx.html#2632" class="Bound">sig</a> <a id="2646" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="2649" href="DEx.html#2463" class="Field">signature</a> <a id="2659" href="DEx.html#2636" class="Bound">ctx</a>


<a id="2665" class="Keyword">data</a> <a id="Input"></a><a id="2670" href="DEx.html#2670" class="Datatype">Input</a> <a id="2676" class="Symbol">:</a> <a id="2678" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2682" class="Keyword">where</a>
  <a id="Input.Update"></a><a id="2690" href="DEx.html#2690" class="InductiveConstructor">Update</a>   <a id="2699" class="Symbol">:</a> <a id="2701" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="2709" class="Symbol">-&gt;</a> <a id="2712" href="DEx.html#771" class="Record">Rational</a> <a id="2721" class="Symbol">-&gt;</a> <a id="2724" href="DEx.html#2670" class="Datatype">Input</a>
  <a id="Input.Exchange"></a><a id="2732" href="DEx.html#2732" class="InductiveConstructor">Exchange</a> <a id="2741" class="Symbol">:</a> <a id="2743" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="2751" class="Symbol">-&gt;</a> <a id="2754" href="DEx.html#163" class="Function">PubKeyHash</a> <a id="2765" class="Symbol">-&gt;</a> <a id="2768" href="DEx.html#2670" class="Datatype">Input</a>
  <a id="Input.Close"></a><a id="2776" href="DEx.html#2776" class="InductiveConstructor">Close</a>    <a id="2785" class="Symbol">:</a> <a id="2787" href="DEx.html#2670" class="Datatype">Input</a>

<a id="2794" class="Symbol">{-#</a> <a id="2798" class="Keyword">COMPILE</a> <a id="2806" class="Keyword">AGDA2HS</a> <a id="2814" href="DEx.html#2670" class="Datatype">Input</a> <a id="2820" class="Symbol">#-}</a>

<a id="2825" class="Keyword">record</a> <a id="Params"></a><a id="2832" href="DEx.html#2832" class="Record">Params</a> <a id="2839" class="Symbol">:</a> <a id="2841" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2845" class="Keyword">where</a>
    <a id="2855" class="Keyword">field</a>
            <a id="Params.sellC"></a><a id="2873" href="DEx.html#2873" class="Field">sellC</a>  <a id="2880" class="Symbol">:</a> <a id="2882" href="DEx.html#196" class="Function">AssetClass</a>
            <a id="Params.buyC"></a><a id="2905" href="DEx.html#2905" class="Field">buyC</a>   <a id="2912" class="Symbol">:</a> <a id="2914" href="DEx.html#196" class="Function">AssetClass</a>
<a id="2925" class="Keyword">open</a> <a id="2930" href="DEx.html#2832" class="Module">Params</a> <a id="2937" class="Keyword">public</a>

<a id="2945" class="Symbol">{-#</a> <a id="2949" class="Keyword">COMPILE</a> <a id="2957" class="Keyword">AGDA2HS</a> <a id="2965" href="DEx.html#2832" class="Record">Params</a> <a id="2972" class="Symbol">#-}</a>

<a id="getContinuingOutputs"></a><a id="2977" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="2998" class="Symbol">:</a> <a id="3000" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="3014" class="Symbol">-&gt;</a> <a id="3017" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3022" href="DEx.html#2192" class="Record">TxOut</a>
<a id="3028" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="3049" class="Keyword">record</a> <a id="3056" class="Symbol">{</a> <a id="3058" href="DEx.html#2369" class="Field">txOutputs</a> <a id="3068" class="Symbol">=</a> <a id="3070" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3073" class="Symbol">;</a> <a id="3075" href="DEx.html#2402" class="Field">inputVal</a> <a id="3084" class="Symbol">=</a> <a id="3086" href="DEx.html#3086" class="Bound">inputVal</a> <a id="3095" class="Symbol">;</a> <a id="3097" href="DEx.html#2430" class="Field">inputAc</a> <a id="3105" class="Symbol">=</a> <a id="3107" href="DEx.html#3107" class="Bound">inputAc</a>
                            <a id="3143" class="Symbol">;</a> <a id="3145" href="DEx.html#2463" class="Field">signature</a> <a id="3155" class="Symbol">=</a> <a id="3157" href="DEx.html#3157" class="Bound">signature</a> <a id="3167" class="Symbol">;</a> <a id="3169" href="DEx.html#2496" class="Field">purpose</a> <a id="3177" class="Symbol">=</a> <a id="3179" class="Symbol">(</a><a id="3180" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="3189" href="DEx.html#3189" class="Bound">x</a><a id="3190" class="Symbol">)</a> <a id="3192" class="Symbol">}</a>
  <a id="3196" class="Symbol">=</a> <a id="3198" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3201" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="3222" class="Keyword">record</a> <a id="3229" class="Symbol">{</a> <a id="3231" href="DEx.html#2369" class="Field">txOutputs</a> <a id="3241" class="Symbol">=</a> <a id="3243" class="Symbol">(</a><a id="3244" href="DEx.html#3244" class="Bound">txO</a> <a id="3248" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3250" href="DEx.html#3250" class="Bound">txOutputs</a><a id="3259" class="Symbol">)</a> <a id="3261" class="Symbol">;</a> <a id="3263" href="DEx.html#2402" class="Field">inputVal</a> <a id="3272" class="Symbol">=</a> <a id="3274" href="DEx.html#3274" class="Bound">inputVal</a> <a id="3283" class="Symbol">;</a> <a id="3285" href="DEx.html#2430" class="Field">inputAc</a> <a id="3293" class="Symbol">=</a> <a id="3295" href="DEx.html#3295" class="Bound">inputAc</a>
                            <a id="3331" class="Symbol">;</a> <a id="3333" href="DEx.html#2463" class="Field">signature</a> <a id="3343" class="Symbol">=</a> <a id="3345" href="DEx.html#3345" class="Bound">signature</a> <a id="3355" class="Symbol">;</a> <a id="3357" href="DEx.html#2496" class="Field">purpose</a> <a id="3365" class="Symbol">=</a> <a id="3367" class="Symbol">(</a><a id="3368" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="3377" href="DEx.html#3377" class="Bound">adr</a><a id="3380" class="Symbol">)</a> <a id="3382" class="Symbol">}</a>
  <a id="3386" class="Symbol">=</a> <a id="3388" href="Haskell.Prim.html#1713" class="Function Operator">if</a> <a id="3391" href="DEx.html#3377" class="Bound">adr</a> <a id="3395" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3398" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="3411" href="DEx.html#3244" class="Bound">txO</a>
       <a id="3422" href="Haskell.Prim.html#1713" class="Function Operator">then</a> <a id="3427" href="DEx.html#3244" class="Bound">txO</a> <a id="3431" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3433" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="3454" class="Symbol">(</a><a id="3455" class="Keyword">record</a> <a id="3462" class="Symbol">{</a> <a id="3464" href="DEx.html#2369" class="Field">txOutputs</a> <a id="3474" class="Symbol">=</a> <a id="3476" href="DEx.html#3250" class="Bound">txOutputs</a> <a id="3486" class="Symbol">;</a> <a id="3488" href="DEx.html#2402" class="Field">inputVal</a> <a id="3497" class="Symbol">=</a> <a id="3499" href="DEx.html#3274" class="Bound">inputVal</a> <a id="3508" class="Symbol">;</a> <a id="3510" href="DEx.html#2430" class="Field">inputAc</a> <a id="3518" class="Symbol">=</a> <a id="3520" href="DEx.html#3295" class="Bound">inputAc</a>
                                                 <a id="3577" class="Symbol">;</a> <a id="3579" href="DEx.html#2463" class="Field">signature</a> <a id="3589" class="Symbol">=</a> <a id="3591" href="DEx.html#3345" class="Bound">signature</a> <a id="3601" class="Symbol">;</a> <a id="3603" href="DEx.html#2496" class="Field">purpose</a> <a id="3611" class="Symbol">=</a> <a id="3613" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="3622" href="DEx.html#3377" class="Bound">adr</a> <a id="3626" class="Symbol">})</a>
       <a id="3636" href="Haskell.Prim.html#1713" class="Function Operator">else</a> <a id="3641" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="3662" class="Symbol">(</a><a id="3663" class="Keyword">record</a> <a id="3670" class="Symbol">{</a> <a id="3672" href="DEx.html#2369" class="Field">txOutputs</a> <a id="3682" class="Symbol">=</a> <a id="3684" href="DEx.html#3250" class="Bound">txOutputs</a> <a id="3694" class="Symbol">;</a> <a id="3696" href="DEx.html#2402" class="Field">inputVal</a> <a id="3705" class="Symbol">=</a> <a id="3707" href="DEx.html#3274" class="Bound">inputVal</a> <a id="3716" class="Symbol">;</a> <a id="3718" href="DEx.html#2430" class="Field">inputAc</a> <a id="3726" class="Symbol">=</a> <a id="3728" href="DEx.html#3295" class="Bound">inputAc</a>
                                           <a id="3779" class="Symbol">;</a> <a id="3781" href="DEx.html#2463" class="Field">signature</a> <a id="3791" class="Symbol">=</a> <a id="3793" href="DEx.html#3345" class="Bound">signature</a> <a id="3803" class="Symbol">;</a> <a id="3805" href="DEx.html#2496" class="Field">purpose</a> <a id="3813" class="Symbol">=</a> <a id="3815" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="3824" href="DEx.html#3377" class="Bound">adr</a> <a id="3828" class="Symbol">})</a>
<a id="3831" href="DEx.html#2977" class="CatchallClause Function">getContinuingOutputs</a><a id="3851" class="CatchallClause"> </a><a id="3852" class="CatchallClause Keyword">record</a><a id="3858" class="CatchallClause"> </a><a id="3859" class="CatchallClause Symbol">{</a><a id="3860" class="CatchallClause"> </a><a id="3861" href="DEx.html#2369" class="CatchallClause Field">txOutputs</a><a id="3870" class="CatchallClause"> </a><a id="3871" class="CatchallClause Symbol">=</a><a id="3872" class="CatchallClause"> </a><a id="3873" href="DEx.html#3873" class="CatchallClause Bound">txOutputs</a><a id="3882" class="CatchallClause"> </a><a id="3883" class="CatchallClause Symbol">;</a><a id="3884" class="CatchallClause"> </a><a id="3885" href="DEx.html#2402" class="CatchallClause Field">inputVal</a><a id="3893" class="CatchallClause"> </a><a id="3894" class="CatchallClause Symbol">=</a><a id="3895" class="CatchallClause"> </a><a id="3896" href="DEx.html#3896" class="CatchallClause Bound">inputVal</a><a id="3904" class="CatchallClause"> </a><a id="3905" class="CatchallClause Symbol">;</a><a id="3906" class="CatchallClause"> </a><a id="3907" href="DEx.html#2430" class="CatchallClause Field">inputAc</a><a id="3914" class="CatchallClause"> </a><a id="3915" class="CatchallClause Symbol">=</a><a id="3916" class="CatchallClause"> </a><a id="3917" href="DEx.html#3917" class="CatchallClause Bound">inputAc</a>
                            <a id="3953" class="Symbol">;</a> <a id="3955" href="DEx.html#2463" class="CatchallClause Field">signature</a><a id="3964" class="CatchallClause"> </a><a id="3965" class="CatchallClause Symbol">=</a><a id="3966" class="CatchallClause"> </a><a id="3967" href="DEx.html#3967" class="CatchallClause Bound">signature</a><a id="3976" class="CatchallClause"> </a><a id="3977" class="CatchallClause Symbol">;</a><a id="3978" class="CatchallClause"> </a><a id="3979" href="DEx.html#2496" class="CatchallClause Field">purpose</a><a id="3986" class="CatchallClause"> </a><a id="3987" class="CatchallClause Symbol">=</a><a id="3988" class="CatchallClause"> </a><a id="3989" class="CatchallClause Symbol">(</a><a id="3990" href="DEx.html#2142" class="CatchallClause InductiveConstructor">Minting</a><a id="3997" class="CatchallClause"> </a><a id="3998" href="DEx.html#3998" class="CatchallClause Bound">x</a><a id="3999" class="CatchallClause Symbol">)</a><a id="4000" class="CatchallClause"> </a><a id="4001" class="CatchallClause Symbol">}</a>
  <a id="4005" class="Symbol">=</a> <a id="4007" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="ownOutput"></a><a id="4011" href="DEx.html#4011" class="Function">ownOutput</a> <a id="4021" class="Symbol">:</a> <a id="4023" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4037" class="Symbol">-&gt;</a> <a id="4040" href="DEx.html#2192" class="Record">TxOut</a>
<a id="4046" href="DEx.html#4011" class="Function">ownOutput</a> <a id="4056" href="DEx.html#4056" class="Bound">ctx</a> <a id="4060" class="Symbol">=</a> <a id="4062" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="4067" class="Symbol">(</a><a id="4068" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="4089" href="DEx.html#4056" class="Bound">ctx</a><a id="4092" class="Symbol">)</a> <a id="4094" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="4097" class="Symbol">λ</a> <a id="4099" class="Keyword">where</a>
  <a id="4107" class="Symbol">(</a><a id="4108" href="DEx.html#4108" class="Bound">o</a> <a id="4110" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4112" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4114" class="Symbol">)</a> <a id="4116" class="Symbol">-&gt;</a> <a id="4119" href="DEx.html#4108" class="Bound">o</a>
  <a id="4123" class="CatchallClause Symbol">_</a> <a id="4125" class="Symbol">-&gt;</a> <a id="4128" class="Keyword">record</a> <a id="4135" class="Symbol">{</a> <a id="4137" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="4150" class="Symbol">=</a> <a id="4152" class="Number">0</a> <a id="4154" class="Symbol">;</a> <a id="4156" href="DEx.html#2249" class="Field">txOutValue</a> <a id="4167" class="Symbol">=</a> <a id="4169" class="Keyword">record</a> <a id="4176" class="Symbol">{</a> <a id="4178" href="DEx.html#261" class="Field">amount</a> <a id="4185" class="Symbol">=</a> <a id="4187" class="Number">-1</a> <a id="4190" class="Symbol">;</a> <a id="4192" href="DEx.html#292" class="Field">currency</a> <a id="4201" class="Symbol">=</a> <a id="4203" class="Number">0</a> <a id="4205" class="Symbol">}</a> <a id="4207" class="Symbol">;</a> <a id="4209" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="4220" class="Symbol">=</a> <a id="4222" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="4230" class="Number">0</a> <a id="4232" class="Symbol">}</a>


<a id="oldValue"></a><a id="4236" href="DEx.html#4236" class="Function">oldValue</a> <a id="4245" class="Symbol">:</a> <a id="4247" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4261" class="Symbol">-&gt;</a> <a id="4264" href="DEx.html#221" class="Record">Value</a>
<a id="4270" href="DEx.html#4236" class="Function">oldValue</a> <a id="4279" href="DEx.html#4279" class="Bound">ctx</a> <a id="4283" class="Symbol">=</a> <a id="4285" href="DEx.html#2402" class="Field">inputVal</a> <a id="4294" href="DEx.html#4279" class="Bound">ctx</a>


<a id="newLabel"></a><a id="4300" href="DEx.html#4300" class="Function">newLabel</a> <a id="4309" class="Symbol">:</a> <a id="4311" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4325" class="Symbol">-&gt;</a> <a id="4328" href="DEx.html#1134" class="Record">Label</a>
<a id="4334" href="DEx.html#4300" class="Function">newLabel</a> <a id="4343" href="DEx.html#4343" class="Bound">ctx</a> <a id="4347" class="Symbol">=</a> <a id="4349" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="4354" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="4365" class="Symbol">(</a><a id="4366" href="DEx.html#4011" class="Function">ownOutput</a> <a id="4376" href="DEx.html#4343" class="Bound">ctx</a><a id="4379" class="Symbol">)</a> <a id="4381" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="4384" class="Symbol">λ</a> <a id="4386" class="Keyword">where</a>
  <a id="4394" class="Symbol">(</a><a id="4395" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="4402" href="DEx.html#4402" class="Bound">x</a><a id="4403" class="Symbol">)</a> <a id="4405" class="Symbol">-&gt;</a> <a id="4408" href="DEx.html#4402" class="Bound">x</a>
  <a id="4412" class="CatchallClause Symbol">_</a> <a id="4414" class="Symbol">-&gt;</a> <a id="4417" class="Keyword">record</a> <a id="4424" class="Symbol">{</a> <a id="4426" href="DEx.html#1164" class="Field">ratio</a> <a id="4432" class="Symbol">=</a> <a id="4434" class="Keyword">record</a> <a id="4441" class="Symbol">{</a> <a id="4443" href="DEx.html#810" class="Field">num</a> <a id="4447" class="Symbol">=</a> <a id="4449" class="Number">0</a> <a id="4451" class="Symbol">;</a> <a id="4453" href="DEx.html#835" class="Field">den</a> <a id="4457" class="Symbol">=</a> <a id="4459" class="Number">0</a> <a id="4461" class="Symbol">}</a> <a id="4463" class="Symbol">;</a> <a id="4465" href="DEx.html#1186" class="Field">owner</a> <a id="4471" class="Symbol">=</a> <a id="4473" class="Number">0</a> <a id="4475" class="Symbol">}</a>

<a id="newValue"></a><a id="4478" href="DEx.html#4478" class="Function">newValue</a> <a id="4487" class="Symbol">:</a> <a id="4489" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4503" class="Symbol">-&gt;</a> <a id="4506" href="DEx.html#221" class="Record">Value</a>
<a id="4512" href="DEx.html#4478" class="Function">newValue</a> <a id="4521" href="DEx.html#4521" class="Bound">ctx</a> <a id="4525" class="Symbol">=</a> <a id="4527" href="DEx.html#2249" class="Field">txOutValue</a> <a id="4538" class="Symbol">(</a><a id="4539" href="DEx.html#4011" class="Function">ownOutput</a> <a id="4549" href="DEx.html#4521" class="Bound">ctx</a><a id="4552" class="Symbol">)</a>

<a id="aux"></a><a id="4555" href="DEx.html#4555" class="Function">aux</a> <a id="4559" class="Symbol">:</a> <a id="4561" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4566" href="DEx.html#2192" class="Record">TxOut</a> <a id="4572" class="Symbol">-&gt;</a> <a id="4575" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4580" href="DEx.html#4555" class="Function">aux</a> <a id="4584" href="DEx.html#4584" class="Bound">txs</a> <a id="4588" class="Symbol">=</a> <a id="4590" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="4595" href="DEx.html#4584" class="Bound">txs</a> <a id="4599" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="4602" class="Symbol">λ</a> <a id="4604" class="Symbol">{</a>
  <a id="4608" class="Symbol">(</a><a id="4609" href="DEx.html#4609" class="Bound">o</a> <a id="4611" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4613" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4615" class="Symbol">)</a> <a id="4617" class="Symbol">-&gt;</a> <a id="4620" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a> <a id="4625" class="Symbol">;</a>
  <a id="4629" class="CatchallClause Symbol">_</a> <a id="4631" class="Symbol">-&gt;</a> <a id="4634" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="4640" class="Symbol">}</a>

<a id="continuing"></a><a id="4643" href="DEx.html#4643" class="Function">continuing</a> <a id="4654" class="Symbol">:</a> <a id="4656" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4670" class="Symbol">-&gt;</a> <a id="4673" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4678" href="DEx.html#4643" class="Function">continuing</a> <a id="4689" href="DEx.html#4689" class="Bound">ctx</a> <a id="4693" class="Symbol">=</a> <a id="4695" href="DEx.html#4555" class="Function">aux</a> <a id="4699" class="Symbol">(</a><a id="4700" href="DEx.html#2977" class="Function">getContinuingOutputs</a> <a id="4721" href="DEx.html#4689" class="Bound">ctx</a><a id="4724" class="Symbol">)</a>
  
<a id="ratioCompare"></a><a id="4729" href="DEx.html#4729" class="Function">ratioCompare</a> <a id="4742" class="Symbol">:</a> <a id="4744" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="4752" class="Symbol">-&gt;</a> <a id="4755" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="4763" class="Symbol">-&gt;</a> <a id="4766" href="DEx.html#771" class="Record">Rational</a> <a id="4775" class="Symbol">-&gt;</a> <a id="4778" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4783" href="DEx.html#4729" class="Function">ratioCompare</a> <a id="4796" href="DEx.html#4796" class="Bound">a</a> <a id="4798" href="DEx.html#4798" class="Bound">b</a> <a id="4800" href="DEx.html#4800" class="Bound">r</a> <a id="4802" class="Symbol">=</a> <a id="4804" href="DEx.html#4796" class="Bound">a</a> <a id="4806" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="4808" class="Symbol">(</a><a id="4809" href="DEx.html#810" class="Field">num</a> <a id="4813" href="DEx.html#4800" class="Bound">r</a><a id="4814" class="Symbol">)</a> <a id="4816" href="Haskell.Prim.Ord.html#1144" class="Field Operator">&lt;=</a> <a id="4819" href="DEx.html#4798" class="Bound">b</a> <a id="4821" href="Haskell.Prim.Num.html#632" class="Field Operator">*</a> <a id="4823" class="Symbol">(</a><a id="4824" href="DEx.html#835" class="Field">den</a> <a id="4828" href="DEx.html#4800" class="Bound">r</a><a id="4829" class="Symbol">)</a>


<a id="getPaymentOutput"></a><a id="4833" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="4850" class="Symbol">:</a> <a id="4852" href="DEx.html#181" class="Function">Address</a> <a id="4860" class="Symbol">-&gt;</a> <a id="4863" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="4877" class="Symbol">-&gt;</a> <a id="4880" href="DEx.html#2192" class="Record">TxOut</a>
<a id="4886" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="4903" href="DEx.html#4903" class="Bound">adr</a> <a id="4907" class="Keyword">record</a> <a id="4914" class="Symbol">{</a> <a id="4916" href="DEx.html#2369" class="Field">txOutputs</a> <a id="4926" class="Symbol">=</a> <a id="4928" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4931" class="Symbol">;</a> <a id="4933" href="DEx.html#2402" class="Field">inputVal</a> <a id="4942" class="Symbol">=</a> <a id="4944" href="DEx.html#4944" class="Bound">inputVal</a> <a id="4953" class="Symbol">;</a> <a id="4955" href="DEx.html#2463" class="Field">signature</a> <a id="4965" class="Symbol">=</a> <a id="4967" href="DEx.html#4967" class="Bound">signature</a> <a id="4977" class="Symbol">;</a> <a id="4979" href="DEx.html#2496" class="Field">purpose</a> <a id="4987" class="Symbol">=</a> <a id="4989" class="Symbol">(</a><a id="4990" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="4999" href="DEx.html#4999" class="Bound">x</a><a id="5000" class="Symbol">)</a> <a id="5002" class="Symbol">}</a>
  <a id="5006" class="Symbol">=</a> <a id="5008" class="Keyword">record</a> <a id="5015" class="Symbol">{</a> <a id="5017" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="5030" class="Symbol">=</a> <a id="5032" class="Number">0</a> <a id="5034" class="Symbol">;</a> <a id="5036" href="DEx.html#2249" class="Field">txOutValue</a> <a id="5047" class="Symbol">=</a> <a id="5049" class="Keyword">record</a> <a id="5056" class="Symbol">{</a> <a id="5058" href="DEx.html#261" class="Field">amount</a> <a id="5065" class="Symbol">=</a> <a id="5067" class="Number">-1</a> <a id="5070" class="Symbol">;</a> <a id="5072" href="DEx.html#292" class="Field">currency</a> <a id="5081" class="Symbol">=</a> <a id="5083" class="Number">0</a> <a id="5085" class="Symbol">}</a>
           <a id="5098" class="Symbol">;</a> <a id="5100" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="5111" class="Symbol">=</a> <a id="5113" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="5120" class="Symbol">(</a><a id="5121" class="Keyword">record</a> <a id="5128" class="Symbol">{</a> <a id="5130" href="DEx.html#1164" class="Field">ratio</a> <a id="5136" class="Symbol">=</a> <a id="5138" class="Keyword">record</a> <a id="5145" class="Symbol">{</a> <a id="5147" href="DEx.html#810" class="Field">num</a> <a id="5151" class="Symbol">=</a> <a id="5153" class="Number">0</a> <a id="5155" class="Symbol">;</a> <a id="5157" href="DEx.html#835" class="Field">den</a> <a id="5161" class="Symbol">=</a> <a id="5163" class="Number">0</a> <a id="5165" class="Symbol">}</a> <a id="5167" class="Symbol">;</a> <a id="5169" href="DEx.html#1186" class="Field">owner</a> <a id="5175" class="Symbol">=</a> <a id="5177" class="Number">0</a> <a id="5179" class="Symbol">})</a> <a id="5182" class="Symbol">}</a>
<a id="5184" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="5201" href="DEx.html#5201" class="Bound">adr</a> <a id="5205" class="Keyword">record</a> <a id="5212" class="Symbol">{</a> <a id="5214" href="DEx.html#2369" class="Field">txOutputs</a> <a id="5224" class="Symbol">=</a> <a id="5226" class="Symbol">(</a><a id="5227" href="DEx.html#5227" class="Bound">txO</a> <a id="5231" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5233" href="DEx.html#5233" class="Bound">txOutputs</a><a id="5242" class="Symbol">)</a> <a id="5244" class="Symbol">;</a> <a id="5246" href="DEx.html#2402" class="Field">inputVal</a> <a id="5255" class="Symbol">=</a> <a id="5257" href="DEx.html#5257" class="Bound">inputVal</a> <a id="5266" class="Symbol">;</a> <a id="5268" href="DEx.html#2430" class="Field">inputAc</a> <a id="5276" class="Symbol">=</a> <a id="5278" href="DEx.html#5278" class="Bound">inputAc</a>
                            <a id="5314" class="Symbol">;</a> <a id="5316" href="DEx.html#2463" class="Field">signature</a> <a id="5326" class="Symbol">=</a> <a id="5328" href="DEx.html#5328" class="Bound">signature</a> <a id="5338" class="Symbol">;</a> <a id="5340" href="DEx.html#2496" class="Field">purpose</a> <a id="5348" class="Symbol">=</a> <a id="5350" class="Symbol">(</a><a id="5351" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="5360" href="DEx.html#5360" class="Bound">x</a><a id="5361" class="Symbol">)</a> <a id="5363" class="Symbol">}</a>
  <a id="5367" class="Symbol">=</a> <a id="5369" href="Haskell.Prim.html#1713" class="Function Operator">if</a> <a id="5372" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="5385" href="DEx.html#5227" class="Bound">txO</a> <a id="5389" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5392" href="DEx.html#5201" class="Bound">adr</a> <a id="5396" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5399" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="5410" href="DEx.html#5227" class="Bound">txO</a> <a id="5414" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5417" class="Symbol">(</a><a id="5418" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="5426" href="DEx.html#5360" class="Bound">x</a><a id="5427" class="Symbol">)</a>
       <a id="5436" href="Haskell.Prim.html#1713" class="Function Operator">then</a> <a id="5441" href="DEx.html#5227" class="Bound">txO</a>
       <a id="5452" href="Haskell.Prim.html#1713" class="Function Operator">else</a> <a id="5457" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="5474" href="DEx.html#5201" class="Bound">adr</a> <a id="5478" class="Symbol">(</a><a id="5479" class="Keyword">record</a> <a id="5486" class="Symbol">{</a> <a id="5488" href="DEx.html#2369" class="Field">txOutputs</a> <a id="5498" class="Symbol">=</a> <a id="5500" href="DEx.html#5233" class="Bound">txOutputs</a> <a id="5510" class="Symbol">;</a> <a id="5512" href="DEx.html#2402" class="Field">inputVal</a> <a id="5521" class="Symbol">=</a> <a id="5523" href="DEx.html#5257" class="Bound">inputVal</a> <a id="5532" class="Symbol">;</a> <a id="5534" href="DEx.html#2430" class="Field">inputAc</a> <a id="5542" class="Symbol">=</a> <a id="5544" href="DEx.html#5278" class="Bound">inputAc</a>
                                 <a id="5585" class="Symbol">;</a> <a id="5587" href="DEx.html#2463" class="Field">signature</a> <a id="5597" class="Symbol">=</a> <a id="5599" href="DEx.html#5328" class="Bound">signature</a> <a id="5609" class="Symbol">;</a> <a id="5611" href="DEx.html#2496" class="Field">purpose</a> <a id="5619" class="Symbol">=</a> <a id="5621" class="Symbol">(</a><a id="5622" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="5631" href="DEx.html#5360" class="Bound">x</a><a id="5632" class="Symbol">)</a> <a id="5634" class="Symbol">})</a>
<a id="5637" href="DEx.html#4833" class="CatchallClause Function">getPaymentOutput</a><a id="5653" class="CatchallClause"> </a><a id="5654" href="DEx.html#5654" class="CatchallClause Bound">adr</a><a id="5657" class="CatchallClause"> </a><a id="5658" class="CatchallClause Keyword">record</a><a id="5664" class="CatchallClause"> </a><a id="5665" class="CatchallClause Symbol">{</a><a id="5666" class="CatchallClause"> </a><a id="5667" href="DEx.html#2369" class="CatchallClause Field">txOutputs</a><a id="5676" class="CatchallClause"> </a><a id="5677" class="CatchallClause Symbol">=</a><a id="5678" class="CatchallClause"> </a><a id="5679" href="DEx.html#5679" class="CatchallClause Bound">txOutputs</a><a id="5688" class="CatchallClause"> </a><a id="5689" class="CatchallClause Symbol">;</a><a id="5690" class="CatchallClause"> </a><a id="5691" href="DEx.html#2402" class="CatchallClause Field">inputVal</a><a id="5699" class="CatchallClause"> </a><a id="5700" class="CatchallClause Symbol">=</a><a id="5701" class="CatchallClause"> </a><a id="5702" href="DEx.html#5702" class="CatchallClause Bound">inputVal</a><a id="5710" class="CatchallClause"> </a><a id="5711" class="CatchallClause Symbol">;</a><a id="5712" class="CatchallClause"> </a><a id="5713" href="DEx.html#2430" class="CatchallClause Field">inputAc</a><a id="5720" class="CatchallClause"> </a><a id="5721" class="CatchallClause Symbol">=</a><a id="5722" class="CatchallClause"> </a><a id="5723" href="DEx.html#5723" class="CatchallClause Bound">inputAc</a>
                            <a id="5759" class="Symbol">;</a> <a id="5761" href="DEx.html#2463" class="CatchallClause Field">signature</a><a id="5770" class="CatchallClause"> </a><a id="5771" class="CatchallClause Symbol">=</a><a id="5772" class="CatchallClause"> </a><a id="5773" href="DEx.html#5773" class="CatchallClause Bound">signature</a><a id="5782" class="CatchallClause"> </a><a id="5783" class="CatchallClause Symbol">;</a><a id="5784" class="CatchallClause"> </a><a id="5785" href="DEx.html#2496" class="CatchallClause Field">purpose</a><a id="5792" class="CatchallClause"> </a><a id="5793" class="CatchallClause Symbol">=</a><a id="5794" class="CatchallClause"> </a><a id="5795" class="CatchallClause Symbol">(</a><a id="5796" href="DEx.html#2142" class="CatchallClause InductiveConstructor">Minting</a><a id="5803" class="CatchallClause"> </a><a id="5804" href="DEx.html#5804" class="CatchallClause Bound">x</a><a id="5805" class="CatchallClause Symbol">)</a><a id="5806" class="CatchallClause"> </a><a id="5807" class="CatchallClause Symbol">}</a>
  <a id="5811" class="Symbol">=</a> <a id="5813" class="Keyword">record</a> <a id="5820" class="Symbol">{</a> <a id="5822" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="5835" class="Symbol">=</a> <a id="5837" class="Number">0</a> <a id="5839" class="Symbol">;</a> <a id="5841" href="DEx.html#2249" class="Field">txOutValue</a> <a id="5852" class="Symbol">=</a> <a id="5854" class="Keyword">record</a> <a id="5861" class="Symbol">{</a> <a id="5863" href="DEx.html#261" class="Field">amount</a> <a id="5870" class="Symbol">=</a> <a id="5872" class="Number">-1</a> <a id="5875" class="Symbol">;</a> <a id="5877" href="DEx.html#292" class="Field">currency</a> <a id="5886" class="Symbol">=</a> <a id="5888" class="Number">0</a> <a id="5890" class="Symbol">}</a>
           <a id="5903" class="Symbol">;</a> <a id="5905" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="5916" class="Symbol">=</a> <a id="5918" href="DEx.html#1769" class="InductiveConstructor">Script</a> <a id="5925" class="Symbol">(</a><a id="5926" class="Keyword">record</a> <a id="5933" class="Symbol">{</a> <a id="5935" href="DEx.html#1164" class="Field">ratio</a> <a id="5941" class="Symbol">=</a> <a id="5943" class="Keyword">record</a> <a id="5950" class="Symbol">{</a> <a id="5952" href="DEx.html#810" class="Field">num</a> <a id="5956" class="Symbol">=</a> <a id="5958" class="Number">0</a> <a id="5960" class="Symbol">;</a> <a id="5962" href="DEx.html#835" class="Field">den</a> <a id="5966" class="Symbol">=</a> <a id="5968" class="Number">0</a> <a id="5970" class="Symbol">}</a> <a id="5972" class="Symbol">;</a> <a id="5974" href="DEx.html#1186" class="Field">owner</a> <a id="5980" class="Symbol">=</a> <a id="5982" class="Number">0</a> <a id="5984" class="Symbol">})</a> <a id="5987" class="Symbol">}</a>


<a id="aux&#39;"></a><a id="5991" href="DEx.html#5991" class="Function">aux&#39;</a> <a id="5996" class="Symbol">:</a> <a id="5998" href="DEx.html#2075" class="Datatype">ScriptPurpose</a> <a id="6012" class="Symbol">-&gt;</a> <a id="6015" href="DEx.html#181" class="Function">Address</a>
<a id="6023" href="DEx.html#5991" class="Function">aux&#39;</a> <a id="6028" href="DEx.html#6028" class="Bound">p</a> <a id="6030" class="Symbol">=</a> <a id="6032" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="6037" href="DEx.html#6028" class="Bound">p</a> <a id="6039" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="6042" class="Symbol">λ</a> <a id="6044" class="Keyword">where</a>
  <a id="6052" class="Symbol">(</a><a id="6053" href="DEx.html#2142" class="InductiveConstructor">Minting</a> <a id="6061" href="DEx.html#6061" class="Bound">cs</a><a id="6063" class="Symbol">)</a> <a id="6065" class="Symbol">-&gt;</a> <a id="6068" class="Number">0</a>
  <a id="6072" class="Symbol">(</a><a id="6073" href="DEx.html#2104" class="InductiveConstructor">Spending</a> <a id="6082" href="DEx.html#6082" class="Bound">adr</a><a id="6085" class="Symbol">)</a> <a id="6087" class="Symbol">-&gt;</a> <a id="6090" href="DEx.html#6082" class="Bound">adr</a>

<a id="getSelf"></a><a id="6095" href="DEx.html#6095" class="Function">getSelf</a> <a id="6103" class="Symbol">:</a> <a id="6105" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="6119" class="Symbol">-&gt;</a> <a id="6122" href="DEx.html#181" class="Function">Address</a>
<a id="6130" href="DEx.html#6095" class="Function">getSelf</a> <a id="6138" href="DEx.html#6138" class="Bound">ctx</a> <a id="6142" class="Symbol">=</a> <a id="6144" href="DEx.html#5991" class="Function">aux&#39;</a> <a id="6149" class="Symbol">(</a><a id="6150" href="DEx.html#2496" class="Field">purpose</a> <a id="6158" href="DEx.html#6138" class="Bound">ctx</a><a id="6161" class="Symbol">)</a> 

<a id="checkPayment"></a><a id="6165" href="DEx.html#6165" class="Function">checkPayment</a> <a id="6178" class="Symbol">:</a> <a id="6180" href="DEx.html#2832" class="Record">Params</a> <a id="6187" class="Symbol">-&gt;</a> <a id="6190" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="6198" class="Symbol">-&gt;</a> <a id="6201" href="DEx.html#1134" class="Record">Label</a> <a id="6207" class="Symbol">-&gt;</a> <a id="6210" href="DEx.html#163" class="Function">PubKeyHash</a> <a id="6221" class="Symbol">-&gt;</a> <a id="6224" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="6238" class="Symbol">-&gt;</a> <a id="6241" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6246" href="DEx.html#6165" class="Function">checkPayment</a> <a id="6259" href="DEx.html#6259" class="Bound">par</a> <a id="6263" href="DEx.html#6263" class="Bound">amt</a> <a id="6267" href="DEx.html#6267" class="Bound">l</a> <a id="6269" href="DEx.html#6269" class="Bound">pkh</a> <a id="6273" href="DEx.html#6273" class="Bound">ctx</a> <a id="6277" class="Symbol">=</a> <a id="6279" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="6292" class="Symbol">(</a><a id="6293" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6310" class="Symbol">(</a><a id="6311" href="DEx.html#1186" class="Field">owner</a> <a id="6317" href="DEx.html#6267" class="Bound">l</a><a id="6318" class="Symbol">)</a> <a id="6320" href="DEx.html#6273" class="Bound">ctx</a><a id="6323" class="Symbol">)</a> <a id="6325" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6328" href="DEx.html#1186" class="Field">owner</a> <a id="6334" href="DEx.html#6267" class="Bound">l</a> <a id="6336" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                                 <a id="6372" href="DEx.html#4729" class="Function">ratioCompare</a> <a id="6385" href="DEx.html#6263" class="Bound">amt</a> <a id="6389" class="Symbol">(</a><a id="6390" href="DEx.html#261" class="Field">amount</a> <a id="6397" class="Symbol">(</a><a id="6398" href="DEx.html#2249" class="Field">txOutValue</a> <a id="6409" class="Symbol">(</a><a id="6410" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6427" class="Symbol">(</a><a id="6428" href="DEx.html#1186" class="Field">owner</a> <a id="6434" href="DEx.html#6267" class="Bound">l</a><a id="6435" class="Symbol">)</a> <a id="6437" href="DEx.html#6273" class="Bound">ctx</a><a id="6440" class="Symbol">)))</a> <a id="6444" class="Symbol">(</a><a id="6445" href="DEx.html#1164" class="Field">ratio</a> <a id="6451" href="DEx.html#6267" class="Bound">l</a><a id="6452" class="Symbol">)</a> <a id="6454" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                                 <a id="6490" href="DEx.html#292" class="Field">currency</a> <a id="6499" class="Symbol">(</a><a id="6500" href="DEx.html#2249" class="Field">txOutValue</a> <a id="6511" class="Symbol">(</a><a id="6512" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6529" class="Symbol">(</a><a id="6530" href="DEx.html#1186" class="Field">owner</a> <a id="6536" href="DEx.html#6267" class="Bound">l</a><a id="6537" class="Symbol">)</a> <a id="6539" href="DEx.html#6273" class="Bound">ctx</a><a id="6542" class="Symbol">))</a> <a id="6545" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6548" href="DEx.html#2905" class="Field">buyC</a> <a id="6553" href="DEx.html#6259" class="Bound">par</a> <a id="6557" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                                 <a id="6593" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="6604" class="Symbol">(</a><a id="6605" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6622" class="Symbol">(</a><a id="6623" href="DEx.html#1186" class="Field">owner</a> <a id="6629" href="DEx.html#6267" class="Bound">l</a><a id="6630" class="Symbol">)</a> <a id="6632" href="DEx.html#6273" class="Bound">ctx</a><a id="6635" class="Symbol">)</a> <a id="6637" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6640" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="6648" class="Symbol">(</a><a id="6649" href="DEx.html#6095" class="Function">getSelf</a> <a id="6657" href="DEx.html#6273" class="Bound">ctx</a><a id="6660" class="Symbol">)</a>


<a id="6664" class="Symbol">{-#</a> <a id="6668" class="Keyword">COMPILE</a> <a id="6676" class="Keyword">AGDA2HS</a> <a id="6684" href="DEx.html#6165" class="Function">checkPayment</a> <a id="6697" class="Symbol">#-}</a>


<a id="checkBuyer"></a><a id="6703" href="DEx.html#6703" class="Function">checkBuyer</a> <a id="6714" class="Symbol">:</a> <a id="6716" href="DEx.html#2832" class="Record">Params</a> <a id="6723" class="Symbol">-&gt;</a> <a id="6726" href="Agda.Builtin.Int.html#245" class="Datatype">Integer</a> <a id="6734" class="Symbol">-&gt;</a> <a id="6737" href="DEx.html#163" class="Function">PubKeyHash</a> <a id="6748" class="Symbol">-&gt;</a> <a id="6751" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="6765" class="Symbol">-&gt;</a> <a id="6768" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6773" href="DEx.html#6703" class="Function">checkBuyer</a> <a id="6784" href="DEx.html#6784" class="Bound">par</a> <a id="6788" href="DEx.html#6788" class="Bound">amt</a> <a id="6792" href="DEx.html#6792" class="Bound">pkh</a> <a id="6796" href="DEx.html#6796" class="Bound">ctx</a> <a id="6800" class="Symbol">=</a> <a id="6802" href="DEx.html#2222" class="Field">txOutAddress</a> <a id="6815" class="Symbol">(</a><a id="6816" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6833" href="DEx.html#6792" class="Bound">pkh</a> <a id="6837" href="DEx.html#6796" class="Bound">ctx</a><a id="6840" class="Symbol">)</a> <a id="6842" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="6845" href="DEx.html#6792" class="Bound">pkh</a> <a id="6849" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                             <a id="6881" class="Symbol">(</a><a id="6882" href="DEx.html#2249" class="Field">txOutValue</a> <a id="6893" class="Symbol">(</a><a id="6894" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="6911" href="DEx.html#6792" class="Bound">pkh</a> <a id="6915" href="DEx.html#6796" class="Bound">ctx</a><a id="6918" class="Symbol">))</a> <a id="6921" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a>
                             <a id="6953" class="Keyword">record</a> <a id="6960" class="Symbol">{</a> <a id="6962" href="DEx.html#261" class="Field">amount</a> <a id="6969" class="Symbol">=</a> <a id="6971" href="DEx.html#6788" class="Bound">amt</a> <a id="6975" class="Symbol">;</a> <a id="6977" href="DEx.html#292" class="Field">currency</a> <a id="6986" class="Symbol">=</a> <a id="6988" href="DEx.html#2873" class="Field">sellC</a> <a id="6994" href="DEx.html#6784" class="Bound">par</a> <a id="6998" class="Symbol">}</a>  <a id="7001" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                             <a id="7033" href="DEx.html#2272" class="Field">txOutDatum</a> <a id="7044" class="Symbol">(</a><a id="7045" href="DEx.html#4833" class="Function">getPaymentOutput</a> <a id="7062" href="DEx.html#6792" class="Bound">pkh</a> <a id="7066" href="DEx.html#6796" class="Bound">ctx</a><a id="7069" class="Symbol">)</a> <a id="7071" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="7074" href="DEx.html#1734" class="InductiveConstructor">Payment</a> <a id="7082" class="Symbol">(</a><a id="7083" href="DEx.html#6095" class="Function">getSelf</a> <a id="7091" href="DEx.html#6796" class="Bound">ctx</a><a id="7094" class="Symbol">)</a>


<a id="7098" class="Symbol">{-#</a> <a id="7102" class="Keyword">COMPILE</a> <a id="7110" class="Keyword">AGDA2HS</a> <a id="7118" href="DEx.html#6703" class="Function">checkBuyer</a> <a id="7129" class="Symbol">#-}</a>

<a id="agdaValidator"></a><a id="7134" href="DEx.html#7134" class="Function">agdaValidator</a> <a id="7148" class="Symbol">:</a> <a id="7150" href="DEx.html#2832" class="Record">Params</a> <a id="7157" class="Symbol">-&gt;</a> <a id="7160" href="DEx.html#1134" class="Record">Label</a> <a id="7166" class="Symbol">-&gt;</a> <a id="7169" href="DEx.html#2670" class="Datatype">Input</a> <a id="7175" class="Symbol">-&gt;</a> <a id="7178" href="DEx.html#2325" class="Record">ScriptContext</a> <a id="7192" class="Symbol">-&gt;</a> <a id="7195" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="7200" href="DEx.html#7134" class="Function">agdaValidator</a> <a id="7214" href="DEx.html#7214" class="Bound">par</a> <a id="7218" href="DEx.html#7218" class="Bound">l</a> <a id="7220" href="DEx.html#7220" class="Bound">red</a> <a id="7224" href="DEx.html#7224" class="Bound">ctx</a> <a id="7228" class="Symbol">=</a> <a id="7230" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="7235" href="DEx.html#7220" class="Bound">red</a> <a id="7239" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="7242" class="Symbol">λ</a> <a id="7244" class="Keyword">where</a>
  <a id="7252" class="Symbol">(</a><a id="7253" href="DEx.html#2690" class="InductiveConstructor">Update</a> <a id="7260" href="DEx.html#7260" class="Bound">amt</a> <a id="7264" href="DEx.html#7264" class="Bound">r</a><a id="7265" class="Symbol">)</a> <a id="7267" class="Symbol">-&gt;</a> <a id="7270" href="DEx.html#2570" class="Function">checkSigned</a> <a id="7282" class="Symbol">(</a><a id="7283" href="DEx.html#1186" class="Field">owner</a> <a id="7289" href="DEx.html#7218" class="Bound">l</a><a id="7290" class="Symbol">)</a> <a id="7292" href="DEx.html#7224" class="Bound">ctx</a> <a id="7296" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                    <a id="7319" href="DEx.html#984" class="Function">checkRational</a> <a id="7333" href="DEx.html#7264" class="Bound">r</a> <a id="7335" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                    <a id="7358" href="DEx.html#4478" class="Function">newValue</a> <a id="7367" href="DEx.html#7224" class="Bound">ctx</a> <a id="7371" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="7374" class="Keyword">record</a> <a id="7381" class="Symbol">{</a> <a id="7383" href="DEx.html#261" class="Field">amount</a> <a id="7390" class="Symbol">=</a> <a id="7392" href="DEx.html#7260" class="Bound">amt</a> <a id="7396" class="Symbol">;</a> <a id="7398" href="DEx.html#292" class="Field">currency</a> <a id="7407" class="Symbol">=</a> <a id="7409" href="DEx.html#2873" class="Field">sellC</a> <a id="7415" href="DEx.html#7214" class="Bound">par</a> <a id="7419" class="Symbol">}</a> <a id="7421" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> 
                    <a id="7445" href="DEx.html#4300" class="Function">newLabel</a> <a id="7454" href="DEx.html#7224" class="Bound">ctx</a> <a id="7458" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="7461" class="Symbol">(</a><a id="7462" class="Keyword">record</a> <a id="7469" class="Symbol">{</a><a id="7470" href="DEx.html#1164" class="Field">ratio</a> <a id="7476" class="Symbol">=</a> <a id="7478" href="DEx.html#7264" class="Bound">r</a> <a id="7480" class="Symbol">;</a> <a id="7482" href="DEx.html#1186" class="Field">owner</a> <a id="7488" class="Symbol">=</a> <a id="7490" href="DEx.html#1186" class="Field">owner</a> <a id="7496" href="DEx.html#7218" class="Bound">l</a><a id="7497" class="Symbol">})</a> <a id="7500" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                    <a id="7523" href="DEx.html#4643" class="Function">continuing</a> <a id="7534" href="DEx.html#7224" class="Bound">ctx</a>
  <a id="7540" class="Symbol">(</a><a id="7541" href="DEx.html#2732" class="InductiveConstructor">Exchange</a> <a id="7550" href="DEx.html#7550" class="Bound">amt</a> <a id="7554" href="DEx.html#7554" class="Bound">pkh</a><a id="7557" class="Symbol">)</a> <a id="7559" class="Symbol">-&gt;</a> <a id="7562" href="DEx.html#4236" class="Function">oldValue</a> <a id="7571" href="DEx.html#7224" class="Bound">ctx</a> <a id="7575" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="7578" class="Symbol">(</a><a id="7579" href="DEx.html#4478" class="Function">newValue</a> <a id="7588" href="DEx.html#7224" class="Bound">ctx</a><a id="7591" class="Symbol">)</a> <a id="7593" href="Haskell.Prim.Monoid.html#344" class="Field Operator">&lt;&gt;</a> <a id="7596" class="Keyword">record</a> <a id="7603" class="Symbol">{</a> <a id="7605" href="DEx.html#261" class="Field">amount</a> <a id="7612" class="Symbol">=</a> <a id="7614" href="DEx.html#7550" class="Bound">amt</a> <a id="7618" class="Symbol">;</a> <a id="7620" href="DEx.html#292" class="Field">currency</a> <a id="7629" class="Symbol">=</a> <a id="7631" href="DEx.html#2873" class="Field">sellC</a> <a id="7637" href="DEx.html#7214" class="Bound">par</a> <a id="7641" class="Symbol">}</a> <a id="7643" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> 
                        <a id="7671" href="DEx.html#4300" class="Function">newLabel</a> <a id="7680" href="DEx.html#7224" class="Bound">ctx</a> <a id="7684" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="7687" href="DEx.html#7218" class="Bound">l</a> <a id="7689" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                        <a id="7716" href="DEx.html#6165" class="Function">checkPayment</a> <a id="7729" href="DEx.html#7214" class="Bound">par</a> <a id="7733" href="DEx.html#7550" class="Bound">amt</a> <a id="7737" href="DEx.html#7218" class="Bound">l</a> <a id="7739" href="DEx.html#7554" class="Bound">pkh</a> <a id="7743" href="DEx.html#7224" class="Bound">ctx</a> <a id="7747" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="7750" href="DEx.html#6703" class="Function">checkBuyer</a> <a id="7761" href="DEx.html#7214" class="Bound">par</a> <a id="7765" href="DEx.html#7550" class="Bound">amt</a> <a id="7769" href="DEx.html#7554" class="Bound">pkh</a> <a id="7773" href="DEx.html#7224" class="Bound">ctx</a> <a id="7777" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
                        <a id="7804" href="DEx.html#4643" class="Function">continuing</a> <a id="7815" href="DEx.html#7224" class="Bound">ctx</a>
  <a id="7821" href="DEx.html#2776" class="InductiveConstructor">Close</a> <a id="7827" class="Symbol">-&gt;</a> <a id="7830" href="Haskell.Prim.Bool.html#273" class="Function">not</a> <a id="7834" class="Symbol">(</a><a id="7835" href="DEx.html#4643" class="Function">continuing</a> <a id="7846" href="DEx.html#7224" class="Bound">ctx</a><a id="7849" class="Symbol">)</a> <a id="7851" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a>
           <a id="7865" href="DEx.html#2570" class="Function">checkSigned</a> <a id="7877" class="Symbol">(</a><a id="7878" href="DEx.html#1186" class="Field">owner</a> <a id="7884" href="DEx.html#7218" class="Bound">l</a><a id="7885" class="Symbol">)</a> <a id="7887" href="DEx.html#7224" class="Bound">ctx</a>


<a id="7893" class="Symbol">{-#</a> <a id="7897" class="Keyword">COMPILE</a> <a id="7905" class="Keyword">AGDA2HS</a> <a id="7913" href="DEx.html#7134" class="Function">agdaValidator</a> <a id="7927" class="Symbol">#-}</a> 
</pre></body></html>